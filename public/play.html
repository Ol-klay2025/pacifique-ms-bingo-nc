<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MS BINGO PACIFIQUE - Jouer</title>
    
    <!-- Vérification de session -->
    <script>
        // Vérifier la session au chargement de la page
        window.addEventListener('load', async function() {
            // Vérifier s'il y a un paramètre direct dans l'URL
            const urlParams = new URLSearchParams(window.location.search);
            const directAccess = urlParams.get('direct');
            
            if (!directAccess) {
                try {
                    const response = await fetch('/api/user', {
                        method: 'GET',
                        credentials: 'include'
                    });
                    
                    if (!response.ok) {
                        // Si non authentifié, rediriger vers la page de connexion
                        window.location.href = '/login.html';
                    }
                } catch (error) {
                    console.error('Erreur de vérification de session:', error);
                }
            }
        });
    </script>
    
    <!-- Styles CSS -->
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/player-manager.css">
    <link rel="stylesheet" href="/css/achievement-showcase.css">
    <style>
        :root {
            --primary-color: #006699;
            --secondary-color: #ff9933;
            --background-color: #003366;
            --card-bg-color: #ffffff;
            --marked-color: #ff6600;
            --quine-color: #33cc33;
            --bingo-color: #cc3300;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background-image: url('images/pacifique-bingo-background.png');
            background-size: cover; /* Changé de contain à cover pour couvrir tout l'écran */
            background-position: center center; /* Centré pour voir l'image complète */
            background-attachment: fixed;
            background-repeat: no-repeat;
            background-color: #003366; /* Couleur de fond coordonnée avec l'image */
            color: white;
            line-height: 1.6;
            padding-bottom: 100px;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden; /* Empêche le défilement horizontal */
        }
        
        /* Styles de la démo intégrés pour interface améliorée */
        .bingo-ball-section {
            background-color: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }
        
        .bingo-container {
            width: 100%;
            height: 220px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
            position: relative;
        }
        
        /* Style pour les boutons de contrôle du tirage alignés horizontalement */
        .side-controls {
            position: relative;
            display: flex;
            flex-direction: row; /* Alignés horizontalement */
            justify-content: center; /* Centré */
            gap: 10px; /* Espace réduit entre les boutons */
            width: 100%;
            margin-top: 10px;
            margin-bottom: 15px;
        }
        
        .side-controls button {
            background-color: #ff9933; /* Orange */
            color: white;
            border: none;
            padding: 8px 12px; /* Taille réduite */
            border-radius: 20px; /* Bordure arrondie moins prononcée */
            font-weight: bold;
            font-size: 0.85rem; /* Police plus petite */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* Ombre plus discrète */
            transition: all 0.2s ease;
            min-width: 120px; /* Largeur minimale pour tous les boutons */
            max-width: 180px; /* Largeur maximale pour tous les boutons */
            text-align: center;
            white-space: nowrap; /* Empêche le texte de passer à la ligne */
            overflow: hidden;
            text-overflow: ellipsis; /* Ajoute ... si le texte est trop long */
        }
        
        .side-controls button:hover {
            background-color: #ff8000;
            transform: scale(1.03); /* Effet de survol plus subtil */
        }
        
        /* Adaptation mobile */
        @media (max-width: 768px) {
            .side-controls {
                flex-wrap: wrap; /* Permettre le retour à la ligne sur petit écran */
                gap: 8px;
            }
            
            .side-controls button {
                flex: 1 1 auto;
                font-size: 0.75rem;
                padding: 6px 8px;
                min-width: 100px;
            }
        }
        
        .game-section {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        /* Styles adaptatifs pour les mobiles */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
                max-width: 100%;
            }
            
            header {
                flex-direction: column;
                padding: 10px 0;
            }
            
            header h1 {
                margin-bottom: 10px;
            }
            
            nav {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            nav a {
                margin: 5px;
                font-size: 12px;
                padding: 6px 10px;
            }
            
            .game-grid {
                flex-direction: column;
            }
            
            .users-panel {
                width: 100%;
                max-width: none;
                position: relative;
                right: auto;
                margin-bottom: 15px;
            }
            
            .bingo-card-container {
                width: 100%;
                overflow-x: auto;
            }
            
            .bingo-card {
                min-width: 300px;
                margin-bottom: 15px;
            }
            
            .drawn-numbers {
                width: 100%;
            }
            
            .game-info {
                width: 100%;
            }
            
            .game-status {
                flex-direction: column;
            }
            
            .game-actions {
                margin-top: 10px;
                width: 100%;
            }
            
            .winners-panel {
                width: 100%;
                margin-bottom: 15px;
            }
            
            .dropdown-content {
                width: 90%;
                min-width: auto;
                right: 0;
                left: 5%;
            }
        }
        
        /* Styles pour les notifications et validation de carte */
        .card-validation-display {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 800px;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            padding: 20px;
            animation: fadeIn 0.3s ease-out;
            overflow-y: auto;
            max-height: 90vh;
        }
        
        @media (max-width: 768px) {
            .card-validation-display {
                width: 95%;
                max-width: none;
                padding: 15px;
            }
            
            .validation-header {
                padding-bottom: 5px;
                margin-bottom: 10px;
            }
        }
        
        .validation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .verification-countdown {
            background-color: #4CAF50;
            color: white;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 20px;
            animation: pulse 1s infinite;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            background-color: rgba(15, 76, 129, 0.9);
            color: white;
            z-index: 1001;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            animation: slideIn 0.3s ease-out;
            max-width: 300px;
        }
        
        @media (max-width: 768px) {
            .notification {
                top: auto;
                bottom: 20px;
                right: 10px;
                left: 10px;
                width: calc(100% - 20px);
                max-width: none;
                animation: slideUp 0.3s ease-out;
            }
            
            @keyframes slideUp {
                from { transform: translateY(100%); opacity: 0; }
                to { transform: translateY(0); opacity: 1; }
            }
        }
        
        .quine-notification {
            background-color: rgba(33, 150, 83, 0.9);
        }
        
        .bingo-notification {
            background-color: rgba(227, 30, 45, 0.9);
        }
        
        .success-notification {
            background-color: rgba(33, 150, 83, 0.9);
        }
        
        .notification-content h3 {
            margin: 0 0 5px 0;
            font-size: 16px;
        }
        
        .notification-content p {
            margin: 0;
            font-size: 14px;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        /* Seconde définition body supprimée pour éviter les conflits */
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 20px;
        }
        
        /* Styles pour le panneau des utilisateurs connectés */
        .users-panel {
            position: fixed;
            right: 5px;
            top: 70px;
            width: 60px; /* Encore plus réduit pour être plus discret */
            background-color: rgba(42, 42, 42, 0.75);
            backdrop-filter: blur(5px);
            border-radius: 8px;
            padding: 10px;
            max-height: 70vh;
            overflow-y: auto;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            z-index: 990;
            transition: all 0.3s ease;
            transform: translateX(5px); /* Légèrement décalé vers la droite par défaut */
            opacity: 0.85; /* Légèrement transparent par défaut */
        }
        
        .users-panel:hover {
            width: 200px; /* Moins large au survol pour prendre moins de place */
            transform: translateX(0); /* Revient à sa position normale */
            opacity: 1; /* Complètement opaque au survol */
        }
        
        .users-panel-header {
            border-bottom: 1px solid #444;
            padding-bottom: 6px;
            margin-bottom: 8px;
            font-weight: bold;
            font-size: 0.8em; /* Police encore plus réduite */
            color: #0099cc;
            display: flex;
            justify-content: space-between;
            align-items: center;
            white-space: nowrap;
            overflow: hidden;
        }
        
        .user-list {
            display: flex;
            flex-direction: column;
            gap: 10px; /* Espacement réduit */
            align-items: center;
        }
        
        .users-panel:hover .user-list {
            align-items: flex-start;
        }
        
        .user-bubble {
            display: flex;
            align-items: center;
            background-color: rgba(0, 153, 204, 0.2);
            border-radius: 50px;
            padding: 6px;
            transition: all 0.3s;
            width: fit-content;
            position: relative;
            margin-bottom: 5px;
        }
        
        .user-bubble:hover {
            background-color: rgba(0, 153, 204, 0.4);
            transform: scale(1.05);
        }
        
        .user-avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background-color: #0099cc;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 8px;
            overflow: hidden;
        }
        
        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .user-avatar-placeholder {
            font-size: 18px;
            color: white;
            font-weight: bold;
        }
        
        .user-info {
            flex: 1;
        }
        
        .user-name {
            font-weight: bold;
            color: white;
            font-size: 12px;
        }
        
        .user-status {
            font-size: 10px;
            color: #aaa;
        }
        
        /* Tableau des quines gagnantes */
        .winners-panel {
            background-color: rgba(42, 42, 42, 0.85);
            backdrop-filter: blur(5px);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }
        
        .winners-panel-header {
            border-bottom: 1px solid #444;
            padding-bottom: 10px;
            margin-bottom: 15px;
            font-weight: bold;
            color: #0099cc;
        }
        
        .winners-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .winner-item {
            display: flex;
            align-items: center;
            background-color: rgba(76, 175, 80, 0.2);
            border-radius: 8px;
            padding: 10px;
            transition: all 0.3s;
        }
        
        .winner-item.quine {
            background-color: rgba(255, 152, 0, 0.2);
        }
        
        .winner-item.bingo {
            background-color: rgba(76, 175, 80, 0.2);
        }
        
        /* Overlay de vérification de quine */
        .quine-verification-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(8px);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 20px;
            animation: fadeIn 0.5s ease-out;
            overflow: auto;
        }
        
        .quine-verification-content {
            background-color: #2a2a2a;
            border-radius: 15px;
            width: 90%;
            max-width: 900px;
            padding: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            animation: slideIn 0.5s ease-out;
            display: flex;
            flex-direction: column;
            gap: 20px;
            max-height: 90vh;
            overflow: auto;
        }
        
        .quine-verification-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #444;
            padding-bottom: 15px;
        }
        
        .quine-verification-header h2 {
            margin: 0;
            color: #ff9800;
            font-size: 24px;
        }
        
        .quine-verification-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        @media (max-width: 768px) {
            .quine-verification-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .quine-verification-card {
            background-color: #333;
            border-radius: 10px;
            overflow: hidden;
            border: 3px solid #ff9800;
        }
        
        .verification-card-header {
            background-color: #ff9800;
            padding: 10px;
            color: white;
            font-weight: bold;
            text-align: center;
        }
        
        .verification-numbers-grid {
            background-color: #f0f0f0;
            padding: 15px;
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            gap: 5px;
            overflow: auto;
            max-height: 300px;
        }
        
        .verification-table {
            background-color: #333;
            border-radius: 10px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .verification-table-header {
            color: #ff9800;
            font-weight: bold;
            border-bottom: 1px solid #444;
            padding-bottom: 10px;
        }
        
        .verification-numbers-list {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
        }
        
        .verification-number {
            background-color: #444;
            border-radius: 5px;
            padding: 8px;
            text-align: center;
            font-weight: bold;
            transition: all 0.3s;
        }
        
        .verification-number.highlighted {
            background-color: #ff9800;
            animation: pulse 1s infinite;
        }
        
        .verification-card-cell {
            padding: 8px;
            text-align: center;
            border: 1px solid #ddd;
            font-size: 16px;
            font-weight: bold;
            background-color: white;
        }
        
        .verification-card-cell.highlighted {
            background-color: #ff9800;
            color: white;
            animation: pulse 1s infinite;
        }
        
        .verification-card-cell.empty {
            background-color: #ddd;
        }
        
        .verification-countdown {
            text-align: center;
            font-size: 18px;
            margin-top: 10px;
            color: #ff9800;
            font-weight: bold;
        }
        
        .quine-verification-close {
            background-color: #ff9800;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 10px;
            align-self: center;
        }
        
        .quine-verification-close:hover {
            background-color: #f57c00;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.8; }
            100% { opacity: 1; }
        }
        
        .winner-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #4CAF50;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 10px;
            overflow: hidden;
            flex-shrink: 0;
        }
        
        .winner-item.quine .winner-avatar {
            background-color: #ff9800;
        }
        
        .winner-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .winner-info {
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        @media (max-width: 768px) {
            .winner-name {
                font-size: 14px;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                max-width: 150px;
            }
            
            .win-type {
                font-size: 10px;
                padding: 1px 6px;
            }
            
            .winner-item {
                padding: 8px;
            }
            
            .winner-avatar {
                width: 35px;
                height: 35px;
                margin-right: 8px;
            }
        }
        
        .winner-name {
            font-weight: bold;
            color: white;
        }
        
        .win-type {
            font-size: 12px;
            color: #ddd;
            background-color: rgba(255, 255, 255, 0.2);
            padding: 2px 8px;
            border-radius: 10px;
            display: inline-block;
        }
        
        /* Styles pour améliorer la lisibilité avec l'image de fond */
        .bingo-card-container, .drawn-numbers, .game-info, header, .customization-panel {
            background-color: rgba(42, 42, 42, 0.85);
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }
        
        header {
            background-color: #0099cc;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        h1 {
            margin: 0;
            color: white;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5);
        }
        
        nav {
            display: flex;
            gap: 10px;
        }
        
        nav a {
            color: white;
            text-decoration: none;
            padding: 8px 15px;
            border-radius: 4px;
            transition: background-color 0.3s;
            position: relative;
        }
        
        nav a:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        nav a.active {
            background-color: rgba(255, 255, 255, 0.3);
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: #e53935;
            color: white;
            font-size: 12px;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .game-info {
            background-color: #2a2a2a;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .game-status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .timer {
            font-size: 24px;
            font-weight: bold;
            color: #0099cc;
        }
        
        .game-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        button {
            background-color: #0099cc;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s, transform 0.2s;
        }
        
        button:hover {
            background-color: #00b3ee;
            transform: translateY(-2px);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        button.primary {
            background-color: #0099cc;
        }
        
        button.success {
            background-color: #4CAF50;
        }
        
        button.warning {
            background-color: #ff9800;
        }
        
        button.danger {
            background-color: #f44336;
        }
        
        button:disabled {
            background-color: #555;
            cursor: not-allowed;
            transform: none;
        }
        
        .game-grid {
            display: flex;
            flex-direction: column;
            gap: 10px; /* Réduit l'espacement vertical entre les éléments */
            width: 100%; /* Pour s'assurer que les éléments prennent toute la largeur */
        }
        
        @media (max-width: 768px) {
            .game-grid {
                grid-template-columns: 1fr;
            }
            
            .container {
                display: flex;
                flex-direction: column;
                padding: 10px;
            }
            
            header {
                flex-direction: column;
                padding: 10px;
            }
            
            header h1 {
                margin-bottom: 10px;
            }
            
            nav {
                flex-wrap: wrap;
                justify-content: center;
                gap: 5px;
            }
            
            nav a {
                padding: 6px 10px;
                font-size: 12px;
                margin: 2px;
                flex-grow: 1;
                text-align: center;
                min-width: 80px;
            }
            
            .users-panel {
                position: fixed;
                right: 0;
                top: auto;
                bottom: 10px;
                width: 70px; /* Taille réduite aussi sur mobile */
                height: auto;
                max-height: 40vh;
                transform: none;
                opacity: 0.7;
                margin-bottom: 0;
                z-index: 995;
            }
            
            .bingo-card-container,
            .drawn-numbers {
                width: 100%;
                overflow-x: auto;
                padding: 10px;
            }
            
            .drawn-numbers-grid {
                grid-template-columns: repeat(6, 1fr);
                grid-template-rows: auto auto;
            }
            
            .column-header {
                font-size: 10px;
            }
            
            .game-status {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .game-actions {
                margin-top: 15px;
                width: 100%;
            }
            
            .game-buttons {
                width: 100%;
                justify-content: space-between;
            }
            
            .card-purchase-options {
                width: 100%;
            }
            
            .dropdown-content {
                width: 100%;
                left: 0;
                right: 0;
            }
            
            .last-number {
                font-size: 36px;
                padding: 10px;
            }
            
            .card-cell {
                font-size: 12px;
                padding: 2px;
            }
        }
        
        .bingo-card-container {
            background-color: #2a2a2a;
            border-radius: 8px;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        
        /* Styles pour l'affichage en colonnes des cartons */
        .bingo-card-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            width: 100%;
        }
        
        .bingo-card-grid.columns-2 {
            grid-template-columns: repeat(2, 1fr);
        }
        
        .bingo-card-grid.columns-3 {
            grid-template-columns: repeat(3, 1fr);
        }
        
        .bingo-card-grid.columns-4 {
            grid-template-columns: repeat(4, 1fr);
        }
        
        @media (max-width: 768px) {
            .bingo-card-grid.columns-3, .bingo-card-grid.columns-4 {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 576px) {
            .bingo-card-grid.columns-2, .bingo-card-grid.columns-3, .bingo-card-grid.columns-4 {
                grid-template-columns: 1fr;
            }
        }
        
        /* Style pour les cartons avec le plus de cases cochées */
        .bingo-card.highlight {
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.7); /* Lueur dorée */
            transform: scale(1.02);
            z-index: 2;
        }
        
        /* Contrôles d'affichage des cartons */
        .card-display-controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .column-controls, .highlight-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            padding: 8px 12px;
        }
        
        .column-controls button, .highlight-controls button {
            background-color: #555;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 5px 10px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .column-controls button:hover, .highlight-controls button:hover {
            background-color: #666;
        }
        
        .column-controls button.active {
            background-color: #0099cc;
        }
        
        .highlight-controls button.active {
            background-color: #e6a500;
        }
        
        .card-counter {
            color: #ccc;
            font-size: 14px;
        }
        
        .drawn-numbers {
            background-color: #2a2a2a;
            border-radius: 8px;
            padding: 20px;
            margin-top: 0; /* Pour s'assurer qu'il n'y a pas d'espace supplémentaire */
        }
        
        .drawn-numbers-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
            margin-top: 15px;
            /* Configuration améliorée pour un affichage uniforme */
            max-height: none;
            overflow: visible;
            /* Assurer que les numéros sont bien alignés */
            justify-content: space-evenly;
            align-items: center;
        }
        
        .number-column {
            display: flex;
            flex-direction: column;
            gap: 8px;
            width: 100%; /* Assure que chaque colonne prend toute la largeur disponible */
            align-items: center; /* Centre les numéros horizontalement */
        }
        
        .column-header {
            text-align: center;
            font-weight: bold;
            font-size: 12px;
            margin-bottom: 8px;
            color: #0099cc;
        }
        
        .number-cell {
            background-color: #333;
            border-radius: 5px;
            padding: 8px 10px;
            text-align: center;
            transition: all 0.3s;
            width: 40px; /* Largeur fixe pour tous les numéros */
            height: 40px; /* Hauteur fixe pour tous les numéros */
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
        }
        
        .number-cell.drawn {
            background-color: #0099cc;
            font-weight: bold;
        }
        
        .last-number {
            font-size: 48px;
            font-weight: bold;
            color: #0099cc;
            text-align: center;
            margin: 20px 0;
            background-color: #333;
            border-radius: 8px;
            padding: 15px;
        }
        
        /* Styles pour les cartes de bingo */
        .bingo-card {
            border: 2px solid #0099cc;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 20px;
            background-color: #333;
        }
        
        /* Partie normale - cartons bleus (par défaut) */
        .bingo-card.normal {
            border-color: #0099cc;
            border-width: 3px;
            background-color: #f0f8ff; /* Bleu très clair */
            box-shadow: 0 4px 12px rgba(0, 153, 204, 0.3);
        }
        
        /* Partie spéciale - cartons verts */
        .bingo-card.special {
            border-color: #4CAF50;
            border-width: 3px;
            background-color: #f0fff5; /* Vert très clair */
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }
        
        /* Série de cartons - rouge */
        .bingo-card.series {
            border-color: #f44336;
            border-width: 3px;
            background-color: #fff5f5; /* Rouge très clair */
            box-shadow: 0 4px 12px rgba(244, 67, 54, 0.3);
        }
        
        .card-header {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
            background-color: #0099cc;
            color: white;
            font-weight: bold;
        }
        
        .bingo-card.normal .card-header {
            background-color: #0099cc;
        }
        
        .bingo-card.special .card-header {
            background-color: #4CAF50;
        }
        
        .bingo-card.series .card-header {
            background-color: #f44336;
        }
        
        .header-cell {
            padding: 5px;
            text-align: center;
            font-size: 12px;
        }
        
        .card-grid {
            display: grid;
            grid-template-rows: repeat(3, 1fr);
        }
        
        .card-row {
            display: grid;
            grid-template-columns: repeat(9, 1fr);
        }
        
        .card-cell {
            padding: 3px;
            text-align: center;
            border: 1px solid #444;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .card-cell.empty {
            background-color: #4CAF50;
            opacity: 0.5;
        }
        
        .card-cell:hover {
            background-color: rgba(0, 153, 204, 0.1);
        }
        
        .card-cell.marked {
            background-color: #0099cc;
            color: white;
        }
        
        .card-cell.free {
            background-color: #444;
            font-size: 12px;
        }
        
        /* Animations pour les tirages */
        @keyframes numberDrawn {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        
        .number-drawn-animation {
            animation: numberDrawn 1s ease-in-out;
        }
        
        /* Auto/Manual marking mode styles */
        body.manual-marking .card-cell {
            cursor: pointer;
        }
        
        body.auto-marking .card-cell {
            cursor: default;
        }
        
        .manual-markup {
            display: none;
        }
        
        body.manual-marking .manual-markup {
            display: block;
            color: #ff9800;
            font-size: 12px;
            margin-top: 5px;
            text-align: center;
        }
        
        .card-footer {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            margin-top: 8px;
            color: #fff;
            background-color: rgba(0, 0, 0, 0.2);
            padding: 5px 8px;
            border-radius: 4px;
        }
        
        .card-id {
            font-weight: bold;
        }
        
        .card-price {
            color: #4CAF50;
        }
        
        /* Styles pour les options d'achat de cartons */
        .card-purchase-options {
            position: relative;
            display: inline-block;
        }
        
        .purchase-type {
            position: relative;
        }
        
        .dropdown-content {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background-color: #fff;
            min-width: 350px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            z-index: 999;
            border-radius: 8px;
            padding: 15px;
            margin-top: 5px;
        }
        
        @media (max-width: 768px) {
            .dropdown-content {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 90%;
                min-width: auto;
                max-height: 80vh;
                overflow-y: auto;
            }
        }
        
        .dropdown-content.show {
            display: block;
        }
        
        .purchase-option {
            padding: 12px;
            border-bottom: 1px solid #eee;
            margin-bottom: 10px;
        }
        
        .purchase-option:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        
        .purchase-option label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }
        
        .quantity-selector {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .quantity-btn {
            width: 30px;
            height: 30px;
            background-color: #f0f0f0;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .quantity-btn:hover {
            background-color: #e0e0e0;
        }
        
        .quantity-selector input {
            width: 50px;
            height: 30px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 0 10px;
            font-size: 14px;
        }
        
        .buy-btn {
            width: 100%;
            padding: 8px 12px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .buy-btn:hover {
            background-color: #3e8e41;
        }
        
        .game-buttons {
            display: flex;
            flex-direction: row; /* Alignement horizontal explicite */
            gap: 10px;
            margin-top: 10px;
            justify-content: center; /* Centrer les boutons */
            width: 100%; /* Occuper toute la largeur disponible */
        }
        
        .game-actions {
            display: flex;
            flex-direction: column;
        }
        
        /* Styles pour les thèmes et personnalisation */
        .customization-panel {
            background-color: #2a2a2a;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .theme-options {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .theme-option {
            width: 80px;
            height: 80px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            border: 2px solid transparent;
            overflow: hidden;
        }
        
        .theme-option.active {
            border-color: #fff;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }
        
        .theme-option:hover {
            transform: translateY(-5px);
        }
        
        .theme-preview {
            width: 100%;
            height: 100%;
        }
        
        .theme-name {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: rgba(0, 0, 0, 0.6);
            color: white;
            padding: 5px;
            font-size: 10px;
            text-align: center;
        }
        
        .color-options {
            margin-bottom: 20px;
        }
        
        .color-option {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .color-label {
            width: 120px;
            font-size: 14px;
        }
        
        .color-picker {
            height: 30px;
            border: none;
            border-radius: 4px;
            background-color: transparent;
            cursor: pointer;
        }
        
        .toggle-option {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .toggle-label {
            margin-right: 10px;
            flex-grow: 1;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 40px;
            height: 20px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #444;
            transition: .4s;
            border-radius: 10px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: #0099cc;
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(20px);
        }
        
        /* Thèmes prédéfinis */
        /* Tropical (par défaut) */
        body[data-theme="tropical"] .bingo-card {
            background-color: #1e1e1e;
            border-color: #0099cc;
        }
        
        body[data-theme="tropical"] .card-header {
            background-color: #0099cc;
        }
        
        body[data-theme="tropical"] .card-cell.empty {
            background-color: #4CAF50;
            opacity: 0.5;
        }
        
        body[data-theme="tropical"] .card-cell.marked {
            background-color: #0099cc;
        }
        
        /* Océanique */
        body[data-theme="ocean"] .bingo-card {
            background-color: #1a3c5e;
            border-color: #64b5f6;
        }
        
        body[data-theme="ocean"] .card-header {
            background-color: #64b5f6;
        }
        
        body[data-theme="ocean"] .card-cell.empty {
            background-color: #4fc3f7;
            opacity: 0.5;
        }
        
        body[data-theme="ocean"] .card-cell.marked {
            background-color: #0277bd;
        }
        
        /* Plage */
        body[data-theme="beach"] .bingo-card {
            background-color: #3e2723;
            border-color: #ffb74d;
        }
        
        body[data-theme="beach"] .card-header {
            background-color: #ffb74d;
            color: #3e2723;
        }
        
        body[data-theme="beach"] .card-cell.empty {
            background-color: #ffe0b2;
            opacity: 0.5;
        }
        
        body[data-theme="beach"] .card-cell.marked {
            background-color: #ff9800;
        }
        
        /* Forêt */
        body[data-theme="forest"] .bingo-card {
            background-color: #1b5e20;
            border-color: #81c784;
        }
        
        body[data-theme="forest"] .card-header {
            background-color: #81c784;
            color: #1b5e20;
        }
        
        body[data-theme="forest"] .card-cell.empty {
            background-color: #c8e6c9;
            opacity: 0.5;
        }
        
        body[data-theme="forest"] .card-cell.marked {
            background-color: #4caf50;
        }
        
        /* Volcan */
        body[data-theme="volcano"] .bingo-card {
            background-color: #4e342e;
            border-color: #ff8a65;
        }
        
        body[data-theme="volcano"] .card-header {
            background-color: #ff8a65;
            color: #3e2723;
        }
        
        body[data-theme="volcano"] .card-cell.empty {
            background-color: #ffccbc;
            opacity: 0.5;
        }
        
        body[data-theme="volcano"] .card-cell.marked {
            background-color: #ff5722;
        }
    </style>
</head>
<body class="auto-marking" data-theme="tropical">
    <!-- Container principal avec l'interface de la démo -->
    <div class="container">
        <div class="game-section">
            <div class="bingo-ball-section">
                <h2>Tirage des Boules</h2>
                <div class="bingo-container" id="bingoBallContainer"></div>
                
                <!-- Timer supprimé sur demande -->
                <div class="timer-container" style="display: none;">
                    <div class="timer" id="timer">3</div>
                </div>
                
                <div class="draw-info">
                    Numéros tirés: <span class="draw-counter" id="drawCounter">0</span> / 90
                </div>
                
                <!-- Repositionnement des boutons de contrôle (en orange) sur le côté -->
                <div class="side-controls">
                    <button id="drawButton">Tirer un numéro</button>
                    <button id="startAutoDrawButton">Démarrer tirage automatique</button>
                    <button id="resetButton">Réinitialiser</button>
                </div>
            </div>
            
            <div class="cards-section">
                <h2>Mes Cartes de Bingo</h2>
                <div class="bingo-cards-container" id="bingoCardsContainer">
                    <!-- Les cartes de bingo seront générées ici -->
                </div>
            </div>
        </div>
    </div>
    <div class="container">
        <header>
            <h1>MS BINGO</h1>
            <nav>
                <a href="/profile">Profil</a>
                <a href="/play" class="active">Jouer</a>
                <a href="/customization" id="customization-btn">Personnalisation</a>
                <a href="/social">Social</a>
                <a href="/kyc.html">Vérification KYC</a>
                <a href="/kyc-guide.html">Guide KYC</a>
                <a href="#" id="social-connect-btn">Connecter</a>
                <a href="#" id="voice-settings-btn" onclick="showVoiceSettings(); return false;">Annonceur</a>
                <a href="#" id="showcase-btn" onclick="window.achievementShowcase.toggleShowcase(); return false;">Achievements</a>
                <a href="/logout" id="logout-btn">Déconnexion</a>
            </nav>
        </header>
        
        <!-- Panneau des joueurs connectés -->
        <div class="users-panel">
            <div class="users-panel-header">
                <span>Joueurs en ligne</span>
                <span id="online-count">5</span>
            </div>
            <div class="user-list" id="user-list">
                <!-- Liste des utilisateurs connectés -->
            </div>
        </div>
        
        <div class="game-info">
            <div class="game-status">
                <div>
                    <h2>Partie en cours</h2>
                    <p>Prochain tirage dans: <span class="timer" id="next-draw-timer">00:30</span></p>
                </div>
                <div class="game-actions">
                    <div class="card-purchase-options">
                        <div class="purchase-type">
                            <button id="buy-card-btn" class="primary">Acheter des cartons</button>
                            <div class="dropdown-content" id="card-purchase-options">
                                <div class="purchase-option">
                                    <label for="single-cards">Partie normale - Cartons bleus:</label>
                                    <div class="quantity-selector">
                                        <button class="quantity-btn minus" data-target="single-cards">-</button>
                                        <input type="number" id="single-cards" min="1" max="10" value="1">
                                        <button class="quantity-btn plus" data-target="single-cards">+</button>
                                    </div>
                                    <button class="buy-btn" data-type="single">Acheter (<span class="price">100</span> fr)</button>
                                </div>
                                <div class="purchase-option">
                                    <label for="special-cards">Partie spéciale - Cartons verts:</label>
                                    <div class="quantity-selector">
                                        <button class="quantity-btn minus" data-target="special-cards">-</button>
                                        <input type="number" id="special-cards" min="1" max="6" value="1">
                                        <button class="quantity-btn plus" data-target="special-cards">+</button>
                                    </div>
                                    <button class="buy-btn special-game-btn" data-type="special">Acheter (<span class="price">300</span> fr)</button>
                                </div>
                                <div class="purchase-option">
                                    <label for="series-cards">Séries complètes - Cartons rouges (6 cartons):</label>
                                    <div class="quantity-selector">
                                        <button class="quantity-btn minus" data-target="series-cards">-</button>
                                        <input type="number" id="series-cards" min="1" max="3" value="1">
                                        <button class="quantity-btn plus" data-target="series-cards">+</button>
                                    </div>
                                    <button class="buy-btn" data-type="series">Acheter (<span class="price">500</span> fr)</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="game-buttons">
                        <button id="quine-btn" class="warning" disabled>Quine!</button>
                        <button id="bingo-btn" class="success" disabled>Bingo!</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Tableau des quines et bingos gagnants -->
        <div class="winners-panel">
            <div class="winners-panel-header">
                <span>Gagnants de la partie en cours (max. 3)</span>
            </div>
            <div class="winners-list" id="winners-list">
                <!-- Les gagnants seront ajoutés ici dynamiquement -->
            </div>
        </div>
        
        <div class="game-grid">
            <!-- Section des cartons de bingo -->
            <div class="bingo-card-container" id="bingo-cards">
                <h2>Vos cartes</h2>
                
                <!-- Contrôles d'affichage des cartons -->
                <div class="card-display-controls">
                    <div class="column-controls">
                        <span>Colonnes:</span>
                        <button data-columns="1" class="active">1</button>
                        <button data-columns="2">2</button>
                        <button data-columns="3">3</button>
                        <button data-columns="4">4</button>
                    </div>
                    <div class="highlight-controls">
                        <span>Mise en évidence:</span>
                        <button data-highlight="none" class="active">Aucune</button>
                        <button data-highlight="most-marked">Les plus marqués</button>
                    </div>
                    <div class="card-counter">
                        <span id="card-count">0</span> cartes au total
                    </div>
                </div>
                
                <!-- Grille pour contenir les cartons -->
                <div id="bingo-card-grid" class="bingo-card-grid columns-1">
                    <!-- Les cartons de bingo seront générés dynamiquement ici -->
                </div>
                
                <!-- Exemple de carton (sera remplacé par les cartons réels) -->
                <div class="bingo-card" style="display:none;">
                    <div class="card-header">
                        <!-- En-têtes numériques pour le format européen -->
                        <div class="header-cell">1-9</div>
                        <div class="header-cell">10-19</div>
                        <div class="header-cell">20-29</div>
                        <div class="header-cell">30-39</div>
                        <div class="header-cell">40-49</div>
                        <div class="header-cell">50-59</div>
                        <div class="header-cell">60-69</div>
                        <div class="header-cell">70-79</div>
                        <div class="header-cell">80-90</div>
                    </div>
                    <div class="card-grid">
                        <div class="card-row">
                            <div class="card-cell">3</div>
                            <div class="card-cell">15</div>
                            <div class="card-cell">24</div>
                            <div class="card-cell empty"></div>
                            <div class="card-cell">42</div>
                            <div class="card-cell empty"></div>
                            <div class="card-cell">63</div>
                            <div class="card-cell empty"></div>
                            <div class="card-cell">85</div>
                        </div>
                        <div class="card-row">
                            <div class="card-cell empty"></div>
                            <div class="card-cell empty"></div>
                            <div class="card-cell empty"></div>
                            <div class="card-cell marked">34</div>
                            <div class="card-cell empty"></div>
                            <div class="card-cell">56</div>
                            <div class="card-cell empty"></div>
                            <div class="card-cell">77</div>
                            <div class="card-cell">89</div>
                        </div>
                        <div class="card-row">
                            <div class="card-cell empty"></div>
                            <div class="card-cell marked">18</div>
                            <div class="card-cell">28</div>
                            <div class="card-cell empty"></div>
                            <div class="card-cell">46</div>
                            <div class="card-cell empty"></div>
                            <div class="card-cell">68</div>
                            <div class="card-cell">73</div>
                            <div class="card-cell empty"></div>
                        </div>
                    </div>
                    <div class="card-footer">
                        <span class="card-id">Carton #1042</span>
                        <span class="card-price">100 fr</span>
                    </div>
                    <div class="manual-markup">Cliquez sur les numéros pour les marquer (mode manuel)</div>
                </div>
            </div>
            
            <!-- Section des derniers numéros tirés supprimée à la demande du client -->
            <!-- Aucun affichage du dernier numéro tiré -->
            
        </div>
    </div>
    
    <!-- CSS de l'animation de chargement -->
    <!-- Animation du boulier désactivée -->
    
    <style>
        .simplified-draw-info {
            background-color: rgba(42, 42, 42, 0.85);
            backdrop-filter: blur(5px);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            text-align: center;
        }
        
        .last-number-display {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .last-number {
            font-size: 48px;
            font-weight: bold;
            color: #0099cc;
            background-color: rgba(255, 255, 255, 0.15);
            border-radius: 50%;
            width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            box-shadow: 0 0 15px rgba(0, 153, 204, 0.5);
        }
        
        .last-number-label {
            font-size: 16px;
            color: white;
            font-weight: bold;
        }
    </style>
    
    <!-- Scripts -->
    <script src="/js/lib/confetti.min.js"></script>
    <script src="/js/voice-announcer.js"></script>
    <script src="/js/bingo-ball-3d.js"></script>
    <script src="/js/bingo-audio.js"></script>
    <script src="/js/bingo-card-marker.js"></script>
    <script src="/js/bingo-enhancements.js"></script>
    <script src="/js/speech-enhancements.js"></script>
    <script src="/js/statistics-analyzer.js"></script>
    <script src="/js/celebration-animations.js"></script>
    <script src="/js/social-share.js"></script>
    <script src="/js/social-integration.js"></script>
    <script src="/js/bingo-integrator.js"></script>
    <script src="/js/player-manager.js"></script>
    <script src="/js/achievement-showcase.js"></script>
    <script src="/js/winning-announcements.js"></script>
    
    <!-- Script d'initialisation pour les boules 3D -->
    <script>
        // Variables d'initialisation
        let bingoBall;
        let bingoAudio;
        let bingoCardMarker;
        let autoDrawInterval;
        let timerInterval;
        let secondsLeft = 3;
        
        // Éléments DOM
        let drawButton;
        let startAutoDrawButton;
        let resetButton;
        let drawCounter;
        let timerElement;
        let bingoContainer;
        
        // Initialisation après le chargement complet de la page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Initialisation du jeu de bingo...');
            
            // Récupérer les éléments du DOM après chargement
            drawButton = document.getElementById('drawButton');
            startAutoDrawButton = document.getElementById('startAutoDrawButton');
            resetButton = document.getElementById('resetButton');
            drawCounter = document.getElementById('drawCounter');
            timerElement = document.getElementById('timer');
            bingoContainer = document.getElementById('bingoBallContainer');
            
            // Initialiser les boules 3D et l'annonceur vocal
            initBingoBalls();
            
            console.log('Initialisation terminée !');
        });
        
        // Fonction pour configurer les écouteurs d'événements
        function setupEventListeners() {
            console.log('Configuration des écouteurs d\'événements...');
            
            // Bouton pour tirer un numéro
            if (drawButton) {
                drawButton.addEventListener('click', drawNumber);
                console.log('Écouteur ajouté sur le bouton de tirage');
            }
            
            // Bouton pour démarrer/arrêter le tirage automatique
            if (startAutoDrawButton) {
                startAutoDrawButton.addEventListener('click', toggleAutoDraw);
                console.log('Écouteur ajouté sur le bouton de tirage automatique');
            }
            
            // Bouton pour réinitialiser le jeu
            if (resetButton) {
                resetButton.addEventListener('click', resetGame);
                console.log('Écouteur ajouté sur le bouton de réinitialisation');
            }
        }
        
        // Fonction pour initialiser les boules de bingo
        function initBingoBalls() {
            // Options des boules
            const options = {
                size: 150,
                colors: ['#FFA500', '#FF69B4', '#32CD32', '#FF6347', '#FF4500', '#FFD700', '#1E90FF', '#20B2AA'],
                highlightColor: '#ffffff',
                animationDuration: 800,
                floatingEffect: true,
                reflectionEffect: true,
                glowEffect: true
            };
            
            // Initialiser la classe BingoBall3D
            bingoBall = new BingoBall3D('bingoBallContainer', options);
            
            // Initialiser le moteur audio avec volume modéré
            bingoAudio = new BingoAudio({
                volume: 0.5,
                muteMusic: false,
                muteSoundEffects: false,
                voiceEnabled: true,
                voiceLanguage: 'fr-FR',
                voiceRate: 0.8,
                voiceGender: 'female'
            });
            
            // Initialiser l'annonceur vocal et l'attacher à window pour qu'il soit accessible globalement
            window.voiceAnnouncer = new VoiceAnnouncer();
            
            // Initialiser le marqueur de cartes
            bingoCardMarker = new BingoCardMarker({
                cardSelector: '.bingo-card',
                cellSelector: '.card-cell', // Adapté au format des cartes dans play.html
                numberDataAttr: 'data-number',
                markedClass: 'marked',
                highlightClass: 'highlight',
                animationClass: 'pulse',
                quineClass: 'quine',
                bingoClass: 'bingo',
                gameRoot: document,
                onQuine: handleQuine,
                onBingo: handleBingo,
                onNumberMarked: handleNumberMarked
            });
            
            // Configuration des écouteurs d'événements
            if (drawButton) {
                drawButton.addEventListener('click', drawNumber);
            }
            
            if (startAutoDrawButton) {
                startAutoDrawButton.addEventListener('click', toggleAutoDraw);
            }
            
            if (resetButton) {
                resetButton.addEventListener('click', resetGame);
            }
        }
        
        // Fonction pour tirer un numéro
        function drawNumber() {
            if (bingoBall) {
                const number = bingoBall.drawNumber();
                
                if (number) {
                    // Mettre à jour le compteur
                    const counter = document.getElementById('drawCounter');
                    if (counter) {
                        const current = parseInt(counter.textContent) || 0;
                        counter.textContent = current + 1;
                    }
                    
                    // Annoncer le numéro en audio
                    if (bingoAudio) {
                        bingoAudio.announceNumber(number);
                    }
                    
                    // Marquer le numéro sur les cartes
                    if (bingoCardMarker) {
                        bingoCardMarker.markNumber(number);
                    }
                }
            }
        }
        
        // Fonction pour basculer le tirage automatique
        function toggleAutoDraw() {
            if (autoDrawInterval) {
                // Arrêter le tirage automatique
                clearInterval(autoDrawInterval);
                autoDrawInterval = null;
                if (startAutoDrawButton) {
                    startAutoDrawButton.textContent = 'Démarrer tirage automatique';
                }
            } else {
                // Tirer un premier numéro immédiatement
                drawNumber();
                
                // Configurer l'intervalle pour les tirages suivants
                autoDrawInterval = setInterval(() => {
                    // Vérifier si tous les numéros ont été tirés
                    if (bingoBall && bingoBall.drawnNumbers.length < 90) {
                        drawNumber();
                    } else {
                        // Tous les numéros ont été tirés, arrêter le tirage automatique
                        clearInterval(autoDrawInterval);
                        autoDrawInterval = null;
                        if (startAutoDrawButton) {
                            startAutoDrawButton.textContent = 'Démarrer tirage automatique';
                        }
                        // Afficher un message
                        const statusElement = document.getElementById('gameStatus');
                        if (statusElement) {
                            statusElement.textContent = 'Tous les numéros ont été tirés';
                        }
                    }
                }, 3000); // Intervalle fixé à 3 secondes entre les tirages
                
                if (startAutoDrawButton) {
                    startAutoDrawButton.textContent = 'Arrêter tirage automatique';
                }
            }
        }
        
        // Fonction pour réinitialiser le jeu
        function resetGame() {
            if (autoDrawInterval) {
                clearInterval(autoDrawInterval);
                autoDrawInterval = null;
                if (startAutoDrawButton) {
                    startAutoDrawButton.textContent = 'Démarrer tirage automatique';
                }
            }
            
            if (bingoBall) {
                bingoBall.reset();
            }
            
            // Réinitialiser le compteur
            const counter = document.getElementById('drawCounter');
            if (counter) {
                counter.textContent = '0';
            }
            
            // Réinitialiser les cartes
            if (bingoCardMarker) {
                bingoCardMarker.reset();
            }
        }
        
        // Gestionnaires d'événements pour les conditions de victoire
        function handleQuine(card) {
            console.log('Quine détectée sur la carte:', card);
            if (bingoAudio) {
                bingoAudio.play('quine');
            }
        }
        
        function handleBingo(card) {
            console.log('Bingo détecté sur la carte:', card);
            if (bingoAudio) {
                bingoAudio.play('bingo');
            }
        }
        
        function handleNumberMarked(number, element) {
            console.log('Numéro marqué:', number);
        }
        
        // Remarque: L'initialisation est déjà gérée plus haut
    </script>
    
    <!-- Script pour l'effet de défilement diagonal des numéros -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Fonction pour appliquer l'effet diagonal aux numéros tirés
        function applyDiagonalEffect() {
            // Sélectionner toutes les cellules de numéros
            const cells = document.querySelectorAll('.number-cell');
            
            // Pour chaque cellule, appliquer une rotation légèrement aléatoire
            cells.forEach((cell, index) => {
                // Calculer l'angle de rotation (-3 à +3 degrés pour effet subtil)
                const rotation = Math.floor(Math.random() * 7) - 3;
                
                // Appliquer une transformation différente selon la position dans la grille
                // pour créer un effet de "diagonale"
                const row = Math.floor(index / 6); // 6 cellules par ligne
                const col = index % 6;
                
                // Décalage diagonal
                const offsetX = (col - 2.5) * 2; // -5 à +5 px
                const offsetY = (row - 2.5) * 2; // -5 à +5 px
                
                // Appliquer les transformations
                cell.style.transform = `rotate(${rotation}deg) translate(${offsetX}px, ${offsetY}px)`;
            });
        }
        
        // Appliquer l'effet initial
        setTimeout(applyDiagonalEffect, 500);
        
        // Observer les changements dans la grille pour appliquer l'effet aux nouveaux numéros
        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
                    // Si de nouveaux nœuds sont ajoutés, appliquer l'effet diagonal
                    applyDiagonalEffect();
                }
            });
        });
        
        // Observer la grille de numéros
        const grid = document.querySelector('.drawn-numbers-grid');
        if (grid) {
            observer.observe(grid, { childList: true, subtree: true });
        }
    });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Animation du boulier désactivée selon la demande
            
            // Simuler un jeu de bingo simplifié (à remplacer par le code réel)
            const game = {
                drawnNumbers: [3, 14, 24, 59],
                timer: 30,
                interval: null,
                gameActive: true,
                
                init: function() {
                    this.setupListeners();
                    this.startTimer();
                    
                    // Pour démonstration: activer les boutons après quelques tirages
                    setTimeout(() => {
                        document.getElementById('quine-btn').disabled = false;
                    }, 5000);
                },
                
                setupListeners: function() {
                    // Gestion du clic sur les cellules des cartes (marquage manuel)
                    document.querySelectorAll('.card-cell').forEach(cell => {
                        cell.addEventListener('click', () => {
                            // Vérifier si le mode manuel est activé
                            if (document.body.classList.contains('manual-marking')) {
                                cell.classList.toggle('marked');
                                
                                // Vérifier les conditions de victoire
                                this.checkWinConditions();
                            }
                        });
                    });
                    
                    // Système d'achat de cartons
                    // Afficher le menu déroulant pour l'achat
                    document.getElementById('buy-card-btn').addEventListener('click', (e) => {
                        e.stopPropagation();
                        const dropdown = document.getElementById('card-purchase-options');
                        dropdown.classList.toggle('show');
                        
                        // Mettre à jour les prix initiaux
                        updatePrices();
                    });
                    
                    // Fermer le menu si on clique ailleurs
                    document.addEventListener('click', (e) => {
                        if (!e.target.closest('.card-purchase-options')) {
                            const dropdown = document.getElementById('card-purchase-options');
                            if (dropdown.classList.contains('show')) {
                                dropdown.classList.remove('show');
                            }
                        }
                    });
                    
                    // Gérer les boutons + et - pour ajuster les quantités
                    document.querySelectorAll('.quantity-btn').forEach(btn => {
                        btn.addEventListener('click', (e) => {
                            e.preventDefault();
                            const targetId = btn.getAttribute('data-target');
                            const input = document.getElementById(targetId);
                            let value = parseInt(input.value);
                            
                            if (btn.classList.contains('minus')) {
                                if (value > parseInt(input.min)) {
                                    input.value = value - 1;
                                }
                            } else {
                                if (value < parseInt(input.max)) {
                                    input.value = value + 1;
                                }
                            }
                            
                            // Mettre à jour les prix
                            updatePrices();
                        });
                    });
                    
                    // Gérer les changements manuels de quantité
                    document.querySelectorAll('.quantity-selector input').forEach(input => {
                        input.addEventListener('change', () => {
                            let value = parseInt(input.value);
                            const min = parseInt(input.min);
                            const max = parseInt(input.max);
                            
                            if (value < min) input.value = min;
                            if (value > max) input.value = max;
                            if (isNaN(value)) input.value = min;
                            
                            // Mettre à jour les prix
                            updatePrices();
                        });
                    });
                    
                    // Fonction pour mettre à jour les prix en fonction des quantités
                    function updatePrices() {
                        const singleCards = parseInt(document.getElementById('single-cards').value) || 1;
                        const specialCards = parseInt(document.getElementById('special-cards').value) || 1;
                        const seriesCards = parseInt(document.getElementById('series-cards').value) || 1;
                        
                        // Prix unitaires
                        const singleCardPrice = 100;   // 100 fr par carton (partie normale)
                        const specialCardPrice = 300;  // 300 fr par carton (partie spéciale)
                        const seriesPrice = 500;       // 500 fr par série (6 cartons)
                        
                        // Calculer et afficher les prix totaux
                        const singleTotalPrice = singleCards * singleCardPrice;
                        const specialTotalPrice = specialCards * specialCardPrice;
                        const seriesTotalPrice = seriesCards * seriesPrice;
                        
                        document.querySelector('.purchase-option:nth-child(1) .price').textContent = singleTotalPrice;
                        document.querySelector('.purchase-option:nth-child(2) .price').textContent = specialTotalPrice;
                        document.querySelector('.purchase-option:nth-child(3) .price').textContent = seriesTotalPrice;
                    }
                    
                    // Gestion des achats
                    document.querySelectorAll('.buy-btn').forEach(btn => {
                        btn.addEventListener('click', () => {
                            const type = btn.getAttribute('data-type');
                            let message, price, quantity, numCartons;
                            
                            if (type === 'single') {
                                quantity = parseInt(document.getElementById('single-cards').value);
                                price = quantity * 100;
                                numCartons = quantity;
                                message = `${quantity} carton${quantity > 1 ? 's' : ''} (partie normale)`;
                                window.currentGameType = 'normal';
                            } else if (type === 'special') {
                                quantity = parseInt(document.getElementById('special-cards').value);
                                price = quantity * 300;
                                numCartons = quantity;
                                message = `${quantity} carton${quantity > 1 ? 's' : ''} (partie spéciale)`;
                                window.currentGameType = 'special';
                            } else if (type === 'series') {
                                quantity = parseInt(document.getElementById('series-cards').value);
                                price = quantity * 500;
                                numCartons = quantity * 6;
                                message = `${quantity} série${quantity > 1 ? 's' : ''} (${numCartons} cartons)`;
                                window.currentGameType = 'series';
                            }
                            
                            // Simuler l'achat
                            const confirmation = confirm(`Confirmer l'achat de ${message} pour ${price} fr ?`);
                            if (confirmation) {
                                // Traitement de l'achat
                                setTimeout(() => {
                                    // Générer les cartons achetés
                                    generateBingoCards(numCartons);
                                    
                                    // Notification de succès
                                    alert(`${message} acheté${type === 'single' && quantity === 1 ? '' : 's'} avec succès pour ${price} fr!`);
                                    
                                    // Fermer le menu
                                    document.getElementById('card-purchase-options').classList.remove('show');
                                }, 500);
                            }
                        });
                    });
                    
                    // Fonction pour générer les cartons de bingo
                    function generateBingoCards(count) {
                        console.log(`Génération de ${count} cartons...`);
                        
                        // Initialiser la grille de cartons si elle n'existe pas encore
                        const cardsContainer = document.getElementById('bingo-cards');
                        const cardGrid = document.getElementById('bingo-card-grid');
                        
                        // Mettre à jour le compteur de cartes
                        const cardCountSpan = document.getElementById('card-count');
                        const currentCount = parseInt(cardCountSpan.textContent) || 0;
                        const newTotalCount = currentCount + count;
                        cardCountSpan.textContent = newTotalCount;
                        
                        // Pour chaque carton à générer
                        for (let i = 0; i < count; i++) {
                            // Générer un carton de bingo au format européen
                            const card = generateEuropeanBingoCard();
                            
                            // Créer l'élément de carton
                            const cardElement = document.createElement('div');
                            cardElement.className = `bingo-card ${window.currentGameType}`;
                            cardElement.innerHTML = `
                                <div class="card-header">
                                    <div class="header-cell">1-9</div>
                                    <div class="header-cell">10-19</div>
                                    <div class="header-cell">20-29</div>
                                    <div class="header-cell">30-39</div>
                                    <div class="header-cell">40-49</div>
                                    <div class="header-cell">50-59</div>
                                    <div class="header-cell">60-69</div>
                                    <div class="header-cell">70-79</div>
                                    <div class="header-cell">80-90</div>
                                </div>
                                <div class="card-grid">
                                    ${generateCardHTML(card)}
                                </div>
                                <div class="card-footer">
                                    <span class="card-id">Carton #${Math.floor(Math.random() * 9000) + 1000}</span>
                                    <span class="card-price">
                                        ${window.currentGameType === 'normal' ? '100' : 
                                          window.currentGameType === 'special' ? '300' : '500'} fr
                                    </span>
                                </div>
                                <div class="manual-markup">Cliquez sur les numéros pour les marquer (mode manuel)</div>
                            `;
                            
                            // Ajouter le carton à la grille de cartons
                            cardGrid.appendChild(cardElement);
                            
                            // Ajouter les écouteurs d'événements pour le marquage manuel
                            addCardListeners(cardElement);
                        }
                        
                        // Notification d'achat
                        const notification = document.createElement('div');
                        notification.className = 'notification success-notification';
                        notification.innerHTML = `
                            <div class="notification-content">
                                <h3>${count} carton${count > 1 ? 's' : ''} acheté${count > 1 ? 's' : ''}!</h3>
                                <p>Bonne chance pour cette partie!</p>
                            </div>
                        `;
                        document.body.appendChild(notification);
                        
                        // Fermer la notification après 3 secondes
                        setTimeout(() => {
                            notification.remove();
                        }, 3000);
                    }
                    
                    // Générer un carton de bingo au format européen (3 lignes x 9 colonnes, 15 numéros)
                    function generateEuropeanBingoCard() {
                        // Un carton européen a 3 lignes et 9 colonnes
                        // Chaque ligne a 5 numéros et 4 cases vides
                        // Les numéros sont répartis dans les colonnes: 1-9, 10-19, 20-29, etc.
                        
                        // Initialiser une carte vide
                        const card = [
                            [0, 0, 0, 0, 0, 0, 0, 0, 0], // Ligne 1
                            [0, 0, 0, 0, 0, 0, 0, 0, 0], // Ligne 2
                            [0, 0, 0, 0, 0, 0, 0, 0, 0]  // Ligne 3
                        ];
                        
                        // Pour chaque colonne
                        for (let col = 0; col < 9; col++) {
                            // Déterminer la plage de numéros pour cette colonne
                            const min = col * 10 + 1;
                            const max = col === 8 ? 90 : (col + 1) * 10;
                            
                            // Générer 3 numéros uniques pour cette colonne
                            const numbers = [];
                            while (numbers.length < 3) {
                                const num = Math.floor(Math.random() * (max - min + 1)) + min;
                                if (!numbers.includes(num)) {
                                    numbers.push(num);
                                }
                            }
                            
                            // Trier les numéros
                            numbers.sort((a, b) => a - b);
                            
                            // Assigner les numéros aux lignes de manière aléatoire
                            // Nous voulons 1 ou 2 numéros par colonne, jamais 3 (règles du bingo européen)
                            const numCount = Math.floor(Math.random() * 2) + 1; // 1 ou 2 numéros
                            
                            if (numCount === 1) {
                                // Placer un seul numéro dans cette colonne
                                const row = Math.floor(Math.random() * 3);
                                card[row][col] = numbers[0];
                            } else {
                                // Placer deux numéros dans cette colonne
                                let row1 = Math.floor(Math.random() * 3);
                                let row2;
                                do {
                                    row2 = Math.floor(Math.random() * 3);
                                } while (row2 === row1);
                                
                                card[row1][col] = numbers[0];
                                card[row2][col] = numbers[1];
                            }
                        }
                        
                        // S'assurer que chaque ligne a exactement 5 numéros (règles du bingo européen)
                        for (let row = 0; row < 3; row++) {
                            // Compter les numéros dans cette ligne
                            const filledCells = card[row].filter(num => num > 0).length;
                            
                            if (filledCells < 5) {
                                // Nous devons ajouter des numéros
                                const emptyCols = [];
                                for (let col = 0; col < 9; col++) {
                                    if (card[row][col] === 0) {
                                        emptyCols.push(col);
                                    }
                                }
                                
                                // Mélanger les colonnes vides
                                shuffleArray(emptyCols);
                                
                                // Ajouter des numéros jusqu'à avoir 5 numéros dans la ligne
                                for (let i = 0; i < 5 - filledCells; i++) {
                                    const col = emptyCols[i];
                                    const min = col * 10 + 1;
                                    const max = col === 8 ? 90 : (col + 1) * 10;
                                    
                                    // Générer un numéro unique pour cette colonne
                                    let num;
                                    do {
                                        num = Math.floor(Math.random() * (max - min + 1)) + min;
                                    } while (card[0][col] === num || card[1][col] === num || card[2][col] === num);
                                    
                                    card[row][col] = num;
                                }
                            } else if (filledCells > 5) {
                                // Nous devons supprimer des numéros
                                const filledCols = [];
                                for (let col = 0; col < 9; col++) {
                                    if (card[row][col] > 0) {
                                        filledCols.push(col);
                                    }
                                }
                                
                                // Mélanger les colonnes remplies
                                shuffleArray(filledCols);
                                
                                // Supprimer des numéros jusqu'à avoir 5 numéros dans la ligne
                                for (let i = 0; i < filledCells - 5; i++) {
                                    const col = filledCols[i];
                                    card[row][col] = 0;
                                }
                            }
                        }
                        
                        return card;
                    }
                    
                    // Générer le HTML pour un carton
                    function generateCardHTML(card) {
                        let html = '';
                        
                        // Pour chaque ligne
                        for (let row = 0; row < 3; row++) {
                            html += '<div class="card-row">';
                            
                            // Pour chaque colonne
                            for (let col = 0; col < 9; col++) {
                                const number = card[row][col];
                                if (number === 0) {
                                    html += '<div class="card-cell empty"></div>';
                                } else {
                                    html += `<div class="card-cell">${number}</div>`;
                                }
                            }
                            
                            html += '</div>';
                        }
                        
                        return html;
                    }
                    
                    // Ajouter les écouteurs d'événements pour le marquage manuel des cartes
                    function addCardListeners(cardElement) {
                        cardElement.querySelectorAll('.card-cell').forEach(cell => {
                            if (!cell.classList.contains('empty')) {
                                cell.addEventListener('click', () => {
                                    if (document.body.classList.contains('manual-marking')) {
                                        cell.classList.toggle('marked');
                                    }
                                });
                            }
                        });
                    }
                    
                    // Fonction utilitaire pour mélanger un tableau
                    function shuffleArray(array) {
                        for (let i = array.length - 1; i > 0; i--) {
                            const j = Math.floor(Math.random() * (i + 1));
                            [array[i], array[j]] = [array[j], array[i]];
                        }
                        return array;
                    }
                    
                    // Bouton de quine
                    document.getElementById('quine-btn').addEventListener('click', () => {
                        // Afficher une notification de quine annoncée
                        const notification = document.createElement('div');
                        notification.className = 'notification quine-notification';
                        notification.innerHTML = `
                            <div class="notification-content">
                                <h3>Quine annoncée dans la salle</h3>
                                <p>Votre carte est en cours de vérification...</p>
                            </div>
                        `;
                        document.body.appendChild(notification);
                        
                        // Simuler la vérification de la quine
                        setTimeout(() => {
                            // Afficher la carte au tableau pendant 10 secondes pour validation
                            const cardDisplayArea = document.createElement('div');
                            cardDisplayArea.className = 'card-validation-display';
                            cardDisplayArea.innerHTML = `
                                <div class="validation-header">
                                    <h3>Vérification de quine en cours</h3>
                                    <div class="verification-countdown">10</div>
                                </div>
                                <div class="validation-card">
                                    <!-- Copie de la carte -->
                                    ${document.querySelector('.bingo-card').outerHTML}
                                </div>
                            `;
                            document.body.appendChild(cardDisplayArea);
                            
                            // Compte à rebours de vérification
                            let verificationTime = 10;
                            const countdownEl = cardDisplayArea.querySelector('.verification-countdown');
                            const verificationInterval = setInterval(() => {
                                verificationTime--;
                                countdownEl.textContent = verificationTime;
                                
                                if (verificationTime <= 0) {
                                    clearInterval(verificationInterval);
                                    
                                    // Supprimer l'affichage de validation
                                    cardDisplayArea.remove();
                                    notification.remove();
                                    
                                    // Afficher la notification de réussite et continuer pour le bingo
                                    const successNotification = document.createElement('div');
                                    successNotification.className = 'notification success-notification';
                                    successNotification.innerHTML = `
                                        <div class="notification-content">
                                            <h3>Quine validée!</h3>
                                            <p>Continuez pour le Bingo!</p>
                                        </div>
                                    `;
                                    document.body.appendChild(successNotification);
                                    
                                    // Fermer la notification de succès après 3 secondes
                                    setTimeout(() => {
                                        successNotification.remove();
                                    }, 3000);
                                    
                                    // Annoncer la quine
                                    const event = new CustomEvent('quine-achieved', {
                                        detail: {
                                            card: {
                                                playerName: 'Vous',
                                                numbers: [
                                                    [3, 16, 31, 47, 62],
                                                    [7, 24, 0, 54, 65],
                                                    [14, 28, 36, 59, 71]
                                                ],
                                                markedNumbers: [3, 14, 24, 59],
                                                winningNumbers: [3, 14, 24, 59, 0]
                                            }
                                        }
                                    });
                                    document.dispatchEvent(event);
                                    
                                    // Déclencher l'événement d'animation de célébration pour la quine
                                    const region = localStorage.getItem('userRegion') || 'default';
                                    const quineEvent = new CustomEvent('bingo:quine', {
                                        detail: { region: region }
                                    });
                                    document.dispatchEvent(quineEvent);
                                    
                                    // Désactiver le bouton de quine et activer le bouton de bingo
                                    document.getElementById('quine-btn').disabled = true;
                                    document.getElementById('bingo-btn').disabled = false;
                                }
                            }, 1000);
                        }, 1500);
                    });
                    
                    // Bouton de bingo
                    document.getElementById('bingo-btn').addEventListener('click', () => {
                        // Afficher une notification de bingo annoncé
                        const notification = document.createElement('div');
                        notification.className = 'notification bingo-notification';
                        notification.innerHTML = `
                            <div class="notification-content">
                                <h3>Bingo annoncé dans la salle</h3>
                                <p>Votre carte est en cours de vérification...</p>
                            </div>
                        `;
                        document.body.appendChild(notification);
                        
                        // Simuler la vérification du bingo
                        setTimeout(() => {
                            // Afficher la carte au tableau pendant 10 secondes pour validation
                            const cardDisplayArea = document.createElement('div');
                            cardDisplayArea.className = 'card-validation-display';
                            cardDisplayArea.innerHTML = `
                                <div class="validation-header">
                                    <h3>Vérification de bingo en cours</h3>
                                    <div class="verification-countdown">10</div>
                                </div>
                                <div class="validation-card">
                                    <!-- Copie de la carte -->
                                    ${document.querySelector('.bingo-card').outerHTML}
                                </div>
                            `;
                            document.body.appendChild(cardDisplayArea);
                            
                            // Compte à rebours de vérification
                            let verificationTime = 10;
                            const countdownEl = cardDisplayArea.querySelector('.verification-countdown');
                            const verificationInterval = setInterval(() => {
                                verificationTime--;
                                countdownEl.textContent = verificationTime;
                                
                                if (verificationTime <= 0) {
                                    clearInterval(verificationInterval);
                                    
                                    // Supprimer l'affichage de validation
                                    cardDisplayArea.remove();
                                    notification.remove();
                                    
                                    // Annoncer le bingo
                                    const event = new CustomEvent('bingo-achieved', {
                                        detail: {
                                            card: {
                                                playerName: 'Vous',
                                                numbers: [
                                                    [3, 16, 31, 47, 62],
                                                    [7, 24, 0, 54, 65],
                                                    [14, 28, 36, 59, 71]
                                                ],
                                                markedNumbers: [3, 14, 24, 59, 16, 31, 47, 62, 7, 54, 65, 28, 36, 71],
                                                winningNumbers: [3, 14, 24, 59, 16, 31, 47, 62, 7, 54, 65, 28, 36, 71, 0]
                                            }
                                        }
                                    });
                                    document.dispatchEvent(event);
                                    
                                    // Déclencher l'événement d'animation de célébration pour le bingo
                                    const region = localStorage.getItem('userRegion') || 'default';
                                    const bingoEvent = new CustomEvent('bingo:bingo', {
                                        detail: { region: region }
                                    });
                                    document.dispatchEvent(bingoEvent);
                                    
                                    // Désactiver le bouton de bingo
                                    document.getElementById('bingo-btn').disabled = true;
                                    
                                    // La partie est maintenant terminée
                                    game.gameActive = false;
                                    document.getElementById('next-draw-timer').textContent = "Terminé";
                                    document.getElementById('next-draw-timer').style.color = "#f44336";
                                    
                                    // Simuler occasionnellement un jackpot (1 chance sur 10)
                                    if (Math.random() < 0.1) {
                                        setTimeout(() => {
                                            const jackpotEvent = new CustomEvent('bingo:jackpot', {
                                                detail: { region: region }
                                            });
                                            document.dispatchEvent(jackpotEvent);
                                        }, 3000);
                                    }
                                }
                            }, 1000);
                        }, 1500);
                    });
                    
                    // Déconnexion
                    document.getElementById('logout-btn').addEventListener('click', (e) => {
                        e.preventDefault();
                        if (confirm('Êtes-vous sûr de vouloir vous déconnecter ?')) {
                            fetch('/api/logout', {
                                method: 'POST',
                                credentials: 'include'
                            }).then(() => {
                                window.location.href = '/';
                            });
                        }
                    });
                    
                    // Navigation vers la page de personnalisation
                    document.getElementById('customization-btn').addEventListener('click', (e) => {
                        e.preventDefault();
                        window.location.href = '/customization';
                    });
                    
                    // Gestion du bouton de connexion sociale
                    document.getElementById('social-connect-btn').addEventListener('click', (e) => {
                        e.preventDefault();
                        if (typeof window.showSocialSettings === 'function') {
                            window.showSocialSettings();
                        } else {
                            alert('La fonctionnalité de connexion sociale n\'est pas disponible. Veuillez vérifier que le script social-integration.js est bien chargé.');
                        }
                    });
                    
                    // Appliquer les préférences personnalisées (thèmes et options)
                    applyUserPreferences();
                    
                    // Émettre un événement pour indiquer le nombre de joueurs
                    const playersEvent = new CustomEvent('players-updated', {
                        detail: { count: 15 }
                    });
                    document.dispatchEvent(playersEvent);
                },
                
                startTimer: function() {
                    // Supprimer le compte à rebours visible et le remplacer par un état "En cours"
                    document.getElementById('next-draw-timer').textContent = "En cours";
                    document.getElementById('next-draw-timer').style.color = "#4CAF50";
                    
                    // Garder l'intervalle pour les tirages mais sans afficher le compte à rebours
                    this.interval = setInterval(() => {
                        if (!this.gameActive) return; // Ne rien faire si la partie est terminée
                        
                        this.drawNextNumber();
                    }, 2000); // Intervalle fixe de 2 secondes entre les tirages
                },
                
                drawNextNumber: function() {
                    // Simuler le tirage d'un nouveau numéro (format européen 1-90)
                    let number = Math.floor(Math.random() * 90) + 1;
                    
                    // Éviter les doublons
                    if (this.drawnNumbers.includes(number)) {
                        this.drawNextNumber();
                        return;
                    }
                    
                    // Ajouter le numéro à la liste des numéros tirés
                    this.drawnNumbers.push(number);
                    
                    // Déterminer la colonne pour ce numéro (format européen)
                    let columnIndex = Math.ceil(number / 10);
                    if (columnIndex > 9) columnIndex = 9; // Assurer que 90 va dans la colonne 9
                    
                    // Mettre à jour l'affichage
                    document.getElementById('last-number').textContent = number;
                    document.getElementById('last-number').classList.add('number-drawn-animation');
                    setTimeout(() => {
                        document.getElementById('last-number').classList.remove('number-drawn-animation');
                    }, 1000);
                    
                    // Ajouter le numéro à la grille des numéros tirés
                    const columnElement = document.getElementById(`column-${columnIndex}`);
                    const numberCell = document.createElement('div');
                    numberCell.className = 'number-cell drawn';
                    numberCell.textContent = number;
                    columnElement.appendChild(numberCell);
                    
                    // En mode automatique, marquer le numéro sur les cartes
                    if (document.body.classList.contains('auto-marking')) {
                        document.querySelectorAll('.card-cell').forEach(cell => {
                            if (parseInt(cell.textContent) === number) {
                                cell.classList.add('marked');
                            }
                        });
                        
                        // Vérifier les conditions de victoire
                        this.checkWinConditions();
                    }
                    
                    // Créer un événement pour l'intégration et l'annonceur vocal
                    const event = new CustomEvent('numberDrawn', {
                        detail: {
                            number,
                            column: columnIndex + 1
                        }
                    });
                    document.dispatchEvent(event);
                },
                
                checkWinConditions: function() {
                    // Logique simplifiée pour vérifier les conditions de victoire
                    // Peut être améliorée dans une implémentation complète
                },
                
                formatTime: function(seconds) {
                    const minutes = Math.floor(seconds / 60);
                    const remainingSeconds = seconds % 60;
                    return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
                }
            };
            
            // Initialiser le jeu
            game.init();
            
            // Gestion des contrôles d'affichage des cartons
            function setupCardDisplayControls() {
                // Contrôle du nombre de colonnes
                document.querySelectorAll('.column-controls button').forEach(button => {
                    button.addEventListener('click', () => {
                        // Retirer la classe active de tous les boutons
                        document.querySelectorAll('.column-controls button').forEach(b => {
                            b.classList.remove('active');
                        });
                        
                        // Ajouter la classe active au bouton cliqué
                        button.classList.add('active');
                        
                        // Obtenir le nombre de colonnes
                        const columns = button.getAttribute('data-columns');
                        
                        // Mettre à jour la classe de la grille de cartons
                        const cardGrid = document.getElementById('bingo-card-grid');
                        cardGrid.className = `bingo-card-grid columns-${columns}`;
                    });
                });
                
                // Contrôle de la mise en évidence des cartons
                document.querySelectorAll('.highlight-controls button').forEach(button => {
                    button.addEventListener('click', () => {
                        // Retirer la classe active de tous les boutons
                        document.querySelectorAll('.highlight-controls button').forEach(b => {
                            b.classList.remove('active');
                        });
                        
                        // Ajouter la classe active au bouton cliqué
                        button.classList.add('active');
                        
                        // Obtenir le type de mise en évidence
                        const highlightType = button.getAttribute('data-highlight');
                        
                        // Supprimer toutes les mises en évidence existantes
                        document.querySelectorAll('.bingo-card').forEach(card => {
                            card.classList.remove('highlight');
                        });
                        
                        // Si on doit mettre en évidence les cartons les plus marqués
                        if (highlightType === 'most-marked') {
                            highlightMostMarkedCards();
                        }
                    });
                });
            }
            
            // Fonction pour mettre en évidence les cartons avec le plus de cases cochées
            function highlightMostMarkedCards() {
                const cards = document.querySelectorAll('.bingo-card');
                
                // S'il n'y a pas de carton, ne rien faire
                if (cards.length === 0) return;
                
                // Calculer le nombre de cases cochées pour chaque carton
                const cardScores = Array.from(cards).map(card => {
                    const markedCells = card.querySelectorAll('.card-cell.marked').length;
                    return { card, markedCells };
                });
                
                // Trier les cartons par nombre de cases cochées (du plus au moins)
                cardScores.sort((a, b) => b.markedCells - a.markedCells);
                
                // S'il n'y a pas de case cochée, ne pas mettre en évidence
                if (cardScores[0].markedCells === 0) return;
                
                // Mettre en évidence les cartons avec le plus de cases cochées
                // (jusqu'à 3 cartons, et seulement ceux qui ont au moins autant que le 3ème)
                const threshold = cardScores.length > 2 ? cardScores[2].markedCells : cardScores[0].markedCells;
                
                cardScores.forEach(({ card, markedCells }) => {
                    if (markedCells >= threshold && markedCells > 0) {
                        card.classList.add('highlight');
                    }
                });
            }
            
            // Mettre à jour la mise en évidence lorsque des cases sont cochées
            document.addEventListener('click', () => {
                const highlightButton = document.querySelector('.highlight-controls button.active');
                if (highlightButton && highlightButton.getAttribute('data-highlight') === 'most-marked') {
                    // Attendre un peu pour que le DOM soit mis à jour
                    setTimeout(highlightMostMarkedCards, 100);
                }
            });
            
            // Initialiser les contrôles d'affichage des cartons
            setupCardDisplayControls();
            
            // Exposer le jeu pour l'intégration
            window.msBingoGame = {
                on: function(event, callback) {
                    document.addEventListener(event, (e) => {
                        if (event === 'numberDrawn' || event === 'quine' || event === 'bingo') {
                            callback(e.detail.number, e.detail.column);
                        } else if (event === 'playersUpdated') {
                            callback(e.detail.count);
                        } else {
                            callback();
                        }
                    });
                },
                getPlayerCount: function() {
                    return 15; // Simulation
                },
                setAutoMarkEnabled: function(enabled) {
                    if (enabled) {
                        document.body.classList.add('auto-marking');
                        document.body.classList.remove('manual-marking');
                    } else {
                        document.body.classList.add('manual-marking');
                        document.body.classList.remove('auto-marking');
                    }
                }
            };
            
            // Fonction pour appliquer les préférences de l'utilisateur
            function applyUserPreferences() {
                // Vérifier s'il y a des préférences sauvegardées dans localStorage
                const savedPreferences = localStorage.getItem('msBingoPreferences');
                
                if (savedPreferences) {
                    const preferences = JSON.parse(savedPreferences);
                    
                    // Appliquer le thème
                    document.body.setAttribute('data-theme', preferences.theme || 'tropical');
                    
                    // Stocker la région de l'utilisateur pour les animations localisées
                    if (preferences.region) {
                        localStorage.setItem('userRegion', preferences.region);
                    } else {
                        // Région par défaut s'il n'y en a pas
                        localStorage.setItem('userRegion', 'default');
                    }
                    
                    // Appliquer les options de marquage automatique/manuel
                    if (preferences.autoMarking === false) {
                        document.body.classList.remove('auto-marking');
                        document.body.classList.add('manual-marking');
                    } else {
                        document.body.classList.add('auto-marking');
                        document.body.classList.remove('manual-marking');
                    }
                    
                    // Appliquer les animations personnalisées
                    if (preferences.cellAnimation === false) {
                        const style = document.createElement('style');
                        style.textContent = '.card-cell.marked { transition: none !important; }';
                        document.head.appendChild(style);
                    }
                    
                    // Appliquer les couleurs personnalisées si mode personnalisé
                    if (preferences.customColors) {
                        const bingoCards = document.querySelectorAll('.bingo-card');
                        const cardHeaders = document.querySelectorAll('.card-header');
                        const cells = document.querySelectorAll('.card-cell:not(.empty):not(.marked)');
                        const emptyCells = document.querySelectorAll('.card-cell.empty');
                        const markedCells = document.querySelectorAll('.card-cell.marked');
                        const headerCells = document.querySelectorAll('.header-cell');
                        
                        bingoCards.forEach(card => {
                            card.style.backgroundColor = preferences.cardBgColor;
                            card.style.borderColor = preferences.headerColor;
                        });
                        
                        cardHeaders.forEach(header => {
                            header.style.backgroundColor = preferences.headerColor;
                        });
                        
                        headerCells.forEach(cell => {
                            cell.style.color = preferences.textColor;
                        });
                        
                        cells.forEach(cell => {
                            cell.style.backgroundColor = preferences.cellColor;
                            cell.style.color = preferences.textColor;
                        });
                        
                        emptyCells.forEach(cell => {
                            cell.style.backgroundColor = preferences.emptyCellColor;
                        });
                        
                        markedCells.forEach(cell => {
                            cell.style.backgroundColor = preferences.markedCellColor;
                            cell.style.color = preferences.textColor;
                        });
                    }
                    
                    // Appliquer l'activation/désactivation du son (si implémenté)
                    window.soundEnabled = preferences.markingSound !== false;
                }
            }
            
            // Désactivé : événement de début de partie qui causait une boucle audio
            // L'événement sera déclenché uniquement lors d'un vrai début de partie
            // setTimeout(() => {
            //     const gameStartedEvent = new Event('gameStarted');
            //     document.dispatchEvent(gameStartedEvent);
            // }, 2000);
            
            // Simuler un événement de fin de partie lorsque le bingo est validé
            document.addEventListener('bingo-achieved', () => {
                // Attendre un peu pour que l'annonce du bingo termine
                setTimeout(() => {
                    const gameEndedEvent = new Event('gameEnded');
                    document.dispatchEvent(gameEndedEvent);
                }, 3000);
            });
        });
    </script>
    
    <!-- Vitrine des réalisations (achievements) -->
    <div id="achievement-showcase-container">
        <div id="achievement-showcase">
            <div class="showcase-header">
                <h2>Vos Réalisations</h2>
                <button class="showcase-close" onclick="window.achievementShowcase.toggleShowcase()">✖</button>
            </div>
            <div id="player-stats">
                <!-- Statistiques du joueur -->
            </div>
            <!-- Contenu de la vitrine des achievements -->
        </div>
    </div>
    
    <!-- Scripts principaux -->
    <script src="/js/player-manager.js"></script>
    <script src="/js/achievement-showcase.js"></script>
    <!-- voice-announcer.js est déjà inclus plus haut -->
    <script src="/js/lucky-number-generator.js"></script>
    <script src="/js/card-animations.js"></script>
    
    <!-- Initialisation du jeu -->
    <script>
        // Variables globales pour le jeu
        window.currentGameType = 'normal'; // 'normal', 'special', ou 'series'
        
        // Fonction pour changer le type de jeu
        function setGameType(type) {
            window.currentGameType = type;
            console.log(`Type de jeu changé: ${type}`);
            
            // Mettre à jour l'apparence des cartons
            const bingoCards = document.querySelectorAll('.bingo-card');
            bingoCards.forEach(card => {
                card.classList.remove('normal', 'special', 'series');
                card.classList.add(type);
            });
            
            // Mettre à jour les prix selon le type de jeu
            let cardPrice = 100; // Prix par défaut pour les parties normales
            
            if (type === 'special') {
                cardPrice = 300;
            } else if (type === 'series') {
                cardPrice = 500; // Une série coûte 500 fr
            }
            
            // Mettre à jour l'affichage des prix
            const priceElements = document.querySelectorAll('.price');
            priceElements.forEach(el => {
                el.textContent = cardPrice;
            });
        }
        
        // Associer les fonctions aux boutons d'achat
        document.addEventListener('DOMContentLoaded', function() {
            // Bouton d'achat de cartons simples (parties normales - bleu)
            const singleBuyBtn = document.querySelector('.buy-btn[data-type="single"]');
            if (singleBuyBtn) {
                singleBuyBtn.addEventListener('click', function() {
                    setGameType('normal');
                    // Logique d'achat existante...
                });
            }
            
            // Bouton d'achat de cartons spéciaux (parties spéciales - vert)
            const specialBuyBtn = document.querySelector('.dropdown-content .special-game-btn');
            if (specialBuyBtn) {
                specialBuyBtn.addEventListener('click', function() {
                    setGameType('special');
                    // Logique d'achat existante...
                });
            }
            
            // Bouton d'achat de séries (rouge)
            const seriesBuyBtn = document.querySelector('.buy-btn[data-type="series"]');
            if (seriesBuyBtn) {
                seriesBuyBtn.addEventListener('click', function() {
                    setGameType('series');
                    // Logique d'achat existante...
                });
            }
            
            // Associer l'événement de fin de partie
            document.addEventListener('gameEnded', function() {
                console.log("Fin de partie détectée - réinitialisation des cartons");
                if (window.playerManager) {
                    window.playerManager.resetCards();
                }
            });
        });
    </script>
    
    <!-- Script pour la vérification de quine -->
    <script>
        // Initialisation pour la vérification de quine
        document.addEventListener('DOMContentLoaded', () => {
            // Écouter l'événement de vérification de quine
            document.addEventListener('quine-verification', (e) => {
                showQuineVerificationOverlay(e.detail.card);
            });
            
            // Modifier le bouton de quine pour déclencher le processus de vérification
            const quineBtn = document.getElementById('quine-btn');
            if (quineBtn) {
                const originalClickHandler = quineBtn.onclick;
                quineBtn.onclick = function(e) {
                    // Appeler le gestionnaire original s'il existe
                    if (typeof originalClickHandler === 'function') {
                        originalClickHandler.call(this, e);
                    }
                    
                    // Récupérer le carton actif
                    const activeCardIndex = parseInt(localStorage.getItem('activeCardIndex') || '0');
                    const cards = document.querySelectorAll('.bingo-card');
                    const activeCard = cards[activeCardIndex];
                    
                    // Créer un objet avec les données du carton pour la vérification
                    if (activeCard) {
                        // Extraire les numéros du carton
                        const cardNumbers = [];
                        const rows = activeCard.querySelectorAll('.card-row');
                        rows.forEach(row => {
                            const rowNumbers = [];
                            const cells = row.querySelectorAll('.card-cell');
                            cells.forEach(cell => {
                                const number = parseInt(cell.textContent) || 0;
                                rowNumbers.push(number);
                            });
                            cardNumbers.push(rowNumbers);
                        });
                        
                        // Trouver les numéros de la quine (ligne complète)
                        const winningNumbers = [];
                        const markedNumbers = [];
                        
                        // Pour simplifier, nous considérons la première ligne comme la quine
                        const firstRowCells = rows[0].querySelectorAll('.card-cell');
                        firstRowCells.forEach(cell => {
                            const number = parseInt(cell.textContent) || 0;
                            winningNumbers.push(number);
                            if (cell.classList.contains('marked')) {
                                markedNumbers.push(number);
                            }
                        });
                        
                        // Créer un objet de données pour le carton
                        const cardData = {
                            playerName: 'Vous',
                            numbers: cardNumbers,
                            markedNumbers: markedNumbers,
                            winningNumbers: winningNumbers
                        };
                        
                        // Désactiver le bouton de quine après la première quine validée
                        quineBtn.disabled = true;
                        quineBtn.textContent = 'Quine déjà validée';
                        quineBtn.style.backgroundColor = '#888';
                        
                        // Si un annonceur vocal est disponible, utiliser sa méthode de quine
                        if (window.voiceAnnouncer) {
                            window.voiceAnnouncer.announceQuine(cardData);
                        } else {
                            // Sinon, déclencher directement l'événement de vérification
                            const verificationEvent = new CustomEvent('quine-verification', {
                                detail: { card: cardData }
                            });
                            document.dispatchEvent(verificationEvent);
                        }
                    }
                };
            }
        });
        
        /**
         * Affiche l'overlay de vérification de quine
         * @param {Object} card - Informations sur la carte avec la quine
         */
        function showQuineVerificationOverlay(card) {
            // Récupérer tous les numéros tirés dans le jeu
            const drawnNumbers = [];
            document.querySelectorAll('.number-cell.drawn').forEach(cell => {
                drawnNumbers.push(parseInt(cell.textContent));
            });
            
            // Mettre la partie en pause
            pauseGame();
            
            // Créer l'overlay
            const overlay = document.createElement('div');
            overlay.className = 'quine-verification-overlay';
            
            // Créer le contenu de vérification
            overlay.innerHTML = `
                <div class="quine-verification-content">
                    <div class="quine-verification-header">
                        <h2>Vérification de Quine</h2>
                        <span>Joueur: ${card.playerName || 'Joueur'}</span>
                    </div>
                    
                    <div class="quine-verification-grid">
                        <div class="quine-verification-card">
                            <div class="verification-card-header">
                                Carton avec Quine
                            </div>
                            <div class="verification-numbers-grid">
                                ${generateCardDisplay(card.numbers)}
                            </div>
                        </div>
                        
                        <div class="verification-table">
                            <div class="verification-table-header">
                                Numéros Tirés
                            </div>
                            <div class="verification-numbers-list">
                                ${generateNumbersList(drawnNumbers)}
                            </div>
                        </div>
                    </div>
                    
                    <div class="verification-countdown">
                        Vérification: <span id="verification-timer">10</span> secondes
                    </div>
                    
                    <button class="quine-verification-close">Fermer</button>
                </div>
            `;
            
            // Fermer toute fenêtre de partage social ouverte avant d'afficher l'overlay de quine
            const socialOverlay = document.querySelector('.social-sharing-overlay');
            if (socialOverlay) {
                socialOverlay.remove();
            }
            
            // Ajouter l'overlay au document avec un z-index élevé pour s'assurer qu'il est au-dessus de tout
            overlay.style.zIndex = "9999";
            document.body.appendChild(overlay);
            
            // Gérer le bouton de fermeture
            const closeButton = overlay.querySelector('.quine-verification-close');
            closeButton.addEventListener('click', () => {
                overlay.remove();
                resumeGame();
            });
            
            // Ajouter des styles spécifiques pour s'assurer que l'overlay est bien visible
            const verificationStyles = document.createElement('style');
            verificationStyles.textContent = `
                .quine-verification-overlay {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background-color: rgba(0, 0, 0, 0.85);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 9999;
                }
                
                .quine-verification-content {
                    background-color: #1a2a3a;
                    border-radius: 12px;
                    max-width: 800px;
                    width: 90%;
                    max-height: 90vh;
                    overflow-y: auto;
                    box-shadow: 0 0 20px rgba(0, 157, 255, 0.5);
                    padding: 20px;
                }
                
                .verification-card-cell.highlighted {
                    background-color: #ff9900;
                    color: #000;
                    box-shadow: 0 0 10px rgba(255, 153, 0, 0.7);
                    transform: scale(1.1);
                    z-index: 1;
                }
                
                .verification-number.highlighted {
                    background-color: #ff9900;
                    color: #000;
                    box-shadow: 0 0 10px rgba(255, 153, 0, 0.7);
                    transform: scale(1.1);
                }
            `;
            document.head.appendChild(verificationStyles);
            
            // Mettre en évidence les numéros gagnants
            setTimeout(highlightWinningNumbers, 1000);
            
            // Compte à rebours
            let secondsLeft = 10;
            const timerEl = document.getElementById('verification-timer');
            
            const countdownInterval = setInterval(() => {
                secondsLeft--;
                timerEl.textContent = secondsLeft;
                
                if (secondsLeft <= 0) {
                    clearInterval(countdownInterval);
                    setTimeout(() => {
                        overlay.remove();
                        resumeGame();
                    }, 1000);
                }
            }, 1000);
            
            /**
             * Génère l'affichage HTML du carton de bingo
             * @param {Array} numbers - Tableau 3x9 des numéros du carton
             * @returns {string} HTML des cellules du carton
             */
            function generateCardDisplay(numbers) {
                let html = '';
                
                // Parcourir toutes les cases possibles (3 lignes x 9 colonnes)
                for (let row = 0; row < 3; row++) {
                    for (let col = 0; col < 9; col++) {
                        const number = numbers[row][col] || 0;
                        
                        // Déterminer si cette case appartient à la quine gagnante
                        let isQuine = false;
                        
                        // Pour une quine (ligne complète), vérifier si c'est la ligne gagnante
                        if (card.winningNumbers && card.winningNumbers.includes(number)) {
                            isQuine = true;
                        }
                        
                        // Créer la cellule avec la classe appropriée
                        if (number === 0) {
                            html += `<div class="verification-card-cell empty"></div>`;
                        } else {
                            html += `<div class="verification-card-cell${isQuine ? ' highlighted' : ''}" data-number="${number}">${number}</div>`;
                        }
                    }
                }
                
                return html;
            }
            
            /**
             * Génère la liste HTML des numéros tirés
             * @param {Array} numbers - Liste des numéros tirés
             * @returns {string} HTML des cellules de numéros
             */
            function generateNumbersList(numbers) {
                let html = '';
                
                // Trier les numéros pour faciliter la vérification
                numbers.sort((a, b) => a - b);
                
                for (let i = 0; i < numbers.length; i++) {
                    const number = numbers[i];
                    // Vérifier si ce numéro fait partie de la quine
                    const isQuine = card.winningNumbers && card.winningNumbers.includes(number);
                    html += `<div class="verification-number${isQuine ? ' highlighted' : ''}" data-number="${number}">${number}</div>`;
                }
                
                return html;
            }
            
            /**
             * Anime la mise en évidence des numéros gagnants
             */
            function highlightWinningNumbers() {
                // Animation des numéros de quine (mettre en surbrillance successivement)
                if (card.winningNumbers && card.winningNumbers.length > 0) {
                    card.winningNumbers.forEach((number, index) => {
                        if (number > 0) { // Ignorer la case libre (0)
                            setTimeout(() => {
                                // Trouver et mettre en surbrillance la cellule dans le carton
                                const cardCell = document.querySelector(`.verification-card-cell[data-number="${number}"]`);
                                if (cardCell) {
                                    cardCell.classList.add('highlighted');
                                }
                                
                                // Trouver et mettre en surbrillance le numéro dans la liste
                                const numberCell = document.querySelector(`.verification-number[data-number="${number}"]`);
                                if (numberCell) {
                                    numberCell.classList.add('highlighted');
                                }
                            }, index * 500); // Espacer les animations de 500ms
                        }
                    });
                }
            }
        }
        
        /**
         * Met le jeu en pause
         */
        function pauseGame() {
            // Si une fonction de pause existe déjà dans le jeu, l'utiliser
            if (typeof window.pauseBingoGame === 'function') {
                window.pauseBingoGame();
            } else {
                // Sinon, implémenter une pause basique
                console.log('Jeu mis en pause pour vérification de quine');
                // Ajouter une classe au body pour indiquer que le jeu est en pause
                document.body.classList.add('game-paused');
                
                // Si un intervalle de tirage est en cours, le mettre en pause
                if (window.gameInterval) {
                    clearInterval(window.gameInterval);
                    window.gameIntervalPaused = true;
                }
                
                // Emettre un événement de pause du jeu
                const pauseEvent = new Event('game-paused');
                document.dispatchEvent(pauseEvent);
            }
        }
        
        /**
         * Reprend le jeu après la pause
         */
        function resumeGame() {
            // Si une fonction de reprise existe déjà dans le jeu, l'utiliser
            if (typeof window.resumeBingoGame === 'function') {
                window.resumeBingoGame();
            } else {
                // Sinon, implémenter une reprise basique
                console.log('Jeu repris après vérification de quine');
                // Enlever la classe de pause
                document.body.classList.remove('game-paused');
                
                // Si un intervalle était en pause, le reprendre
                if (window.gameIntervalPaused && typeof window.startGameInterval === 'function') {
                    window.gameIntervalPaused = false;
                    window.startGameInterval();
                }
                
                // Emettre un événement de reprise du jeu
                const resumeEvent = new Event('game-resumed');
                document.dispatchEvent(resumeEvent);
            }
        }
    </script>
    
    <!-- Script de gestion des cookies RGPD -->
    <script src="/js/cookie-consent.js"></script>
</body>
</html>