<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <title>PACIFIQUE MS BINGO - Administration</title>
  <style>
    body {
      font-family: 'Trebuchet MS', Arial, sans-serif;
      background-color: #1a1a1a;
      color: white;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background-color: #2d2d2d;
      border-bottom: 1px solid #444;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }
    .logo {
      color: #ff3b3b;
      font-size: 24px;
      font-weight: bold;
    }
    .user-info {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .user-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: #ff3b3b;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: white;
    }
    .navbar {
      background-color: #2d2d2d;
      padding: 0 20px;
    }
    .nav-links {
      display: flex;
      list-style-type: none;
      padding: 0;
      margin: 0;
    }
    .nav-links li {
      margin-right: 5px;
    }
    .nav-links a {
      display: block;
      color: white;
      text-decoration: none;
      padding: 15px 20px;
      transition: background-color 0.3s;
    }
    .nav-links a:hover,
    .nav-links a.active {
      background-color: #ff3b3b;
    }
    .main-content {
      padding: 20px;
    }
    .dashboard {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    .card {
      background-color: #2d2d2d;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
    }
    .card h2 {
      margin-top: 0;
      font-size: 18px;
      color: #ff3b3b;
      border-bottom: 1px solid #444;
      padding-bottom: 10px;
    }
    .stat-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 15px;
    }
    .stat-item {
      background-color: #333;
      border-radius: 8px;
      padding: 15px;
      text-align: center;
    }
    .stat-value {
      font-size: 28px;
      font-weight: bold;
      margin-bottom: 5px;
    }
    .stat-label {
      color: #aaa;
      font-size: 14px;
    }
    .action-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 15px;
    }
    .btn {
      background-color: #ff3b3b;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      text-decoration: none;
      font-weight: bold;
    }
    .btn-secondary {
      background-color: #555;
    }
    .btn:hover {
      opacity: 0.9;
    }
    .game-controls {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }
    .status-box {
      background-color: #333;
      border-radius: 5px;
      padding: 10px 15px;
      display: inline-block;
      margin-right: 10px;
    }
    .status-label {
      color: #aaa;
      font-size: 12px;
      margin-bottom: 3px;
    }
    .status-value {
      font-weight: bold;
    }
    .active-status {
      color: #4CAF50;
    }
    .inactive-status {
      color: #f44336;
    }
    .game-display {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
    }
    .game-board {
      flex: 1;
      min-height: 400px;
      background-color: #2d2d2d;
      border-radius: 8px;
      padding: 20px;
      display: flex;
      flex-direction: column;
    }
    .bingo-grid {
      display: grid;
      grid-template-columns: repeat(9, 1fr);
      gap: 5px;
      margin-top: 20px;
    }
    .bingo-cell {
      aspect-ratio: 1;
      background-color: #333;
      border-radius: 5px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: white;
      font-size: 12px;
    }
    .drawn {
      background-color: #ff3b3b;
    }
    .chat-panel {
      width: 300px;
      background-color: #2d2d2d;
      border-radius: 8px;
      display: flex;
      flex-direction: column;
    }
    .chat-header {
      padding: 15px;
      border-bottom: 1px solid #444;
      font-weight: bold;
    }
    .chat-messages {
      flex: 1;
      padding: 15px;
      overflow-y: auto;
      max-height: 300px;
    }
    .chat-input {
      padding: 15px;
      border-top: 1px solid #444;
    }
    .input-group {
      display: flex;
      gap: 10px;
    }
    .input-group input {
      flex: 1;
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #444;
      background-color: #333;
      color: white;
    }
    .input-group button {
      background-color: #ff3b3b;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 0 15px;
      cursor: pointer;
    }
    .user-list {
      list-style-type: none;
      padding: 0;
    }
    .user-list li {
      padding: 10px;
      border-bottom: 1px solid #444;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .user-list li:last-child {
      border-bottom: none;
    }
    .actions {
      display: flex;
      gap: 5px;
    }
    .actions button {
      background-color: transparent;
      border: none;
      color: #aaa;
      cursor: pointer;
      font-size: 14px;
    }
    .actions button:hover {
      color: white;
    }
    .card-preview {
      background-color: #333;
      padding: 10px;
      border-radius: 5px;
      margin-bottom: 10px;
    }
    .card-grid {
      display: grid;
      grid-template-columns: repeat(9, 1fr);
      gap: 5px;
    }
    .card-cell {
      aspect-ratio: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      background-color: #444;
      border-radius: 3px;
    }
    .card-cell:empty {
      background-color: #2d2d2d;
    }
    .footer {
      text-align: center;
      padding: 20px;
      color: #aaa;
      font-size: 12px;
      margin-top: 50px;
      border-top: 1px solid #444;
    }
    .maintenance-toggle {
      display: flex;
      align-items: center;
      margin-top: 15px;
    }
    .switch {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 34px;
      margin-right: 10px;
    }
    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #555;
      transition: .4s;
      border-radius: 34px;
    }
    .slider:before {
      position: absolute;
      content: "";
      height: 26px;
      width: 26px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }
    input:checked + .slider {
      background-color: #ff3b3b;
    }
    input:checked + .slider:before {
      transform: translateX(26px);
    }
    .toggle-label {
      font-weight: bold;
    }
    /* Responsive design */
    @media (max-width: 768px) {
      .game-display {
        flex-direction: column;
      }
      .chat-panel {
        width: 100%;
      }
      .nav-links {
        flex-wrap: wrap;
      }
      .card-preview {
        overflow-x: auto;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="logo">
      <img src="/img/logo.png" alt="PACIFIQUE MS BINGO" style="max-width: 250px;">
    </div>
    <div class="user-info">
      <div class="user-avatar">A</div>
      <div>Admin</div>
      <a href="/admin-logout" class="btn btn-secondary">Déconnexion</a>
    </div>
  </div>
  
  <nav class="navbar">
    <ul class="nav-links">
      <li><a href="#" class="active" data-panel="dashboard">Tableau de bord</a></li>
      <li><a href="#" data-panel="games">Gestion des parties</a></li>
      <li><a href="#" data-panel="users">Utilisateurs</a></li>
      <li><a href="#" data-panel="transactions">Transactions</a></li>
      <li><a href="#" data-panel="jackpot">Jackpot</a></li>
      <li><a href="#" data-panel="settings">Configuration</a></li>
    </ul>
  </nav>
  
  <div class="container">
    <div class="main-content">
      <!-- Panneau: Tableau de bord -->
      <div id="dashboard-panel" class="panel active">
        <h1>Tableau de bord administrateur</h1>
        
        <div class="dashboard">
          <div class="card">
            <h2>Statistiques</h2>
            <div class="stat-grid">
              <div class="stat-item">
                <div class="stat-value" id="users-count">0</div>
                <div class="stat-label">Utilisateurs</div>
              </div>
              <div class="stat-item">
                <div class="stat-value" id="games-count">0</div>
                <div class="stat-label">Parties jouées</div>
              </div>
              <div class="stat-item">
                <div class="stat-value" id="cards-count">0</div>
                <div class="stat-label">Cartes vendues</div>
              </div>
              <div class="stat-item">
                <div class="stat-value" id="jackpot-amount">100000</div>
                <div class="stat-label">Jackpot (Fr)</div>
              </div>
            </div>
            <div class="action-buttons">
              <a href="#" class="btn">Voir les détails</a>
            </div>
          </div>
          
          <div class="card">
            <h2>État du système</h2>
            <div>
              <div class="status-box">
                <div class="status-label">État du serveur</div>
                <div class="status-value active-status">En ligne</div>
              </div>
              <div class="status-box">
                <div class="status-label">Prochaine partie</div>
                <div class="status-value">--:--</div>
              </div>
              <div class="status-box">
                <div class="status-label">WebSocket</div>
                <div class="status-value active-status">Connecté</div>
              </div>
            </div>
            <div class="maintenance-toggle">
              <label class="switch">
                <input type="checkbox" id="maintenance-mode">
                <span class="slider"></span>
              </label>
              <span class="toggle-label">Mode maintenance</span>
            </div>
            <div class="action-buttons">
              <button class="btn" id="start-test-game">Lancer une partie test</button>
              <button class="btn" id="check-db">Vérifier la base de données</button>
            </div>
          </div>
          
          <div class="card">
            <h2>Actions rapides</h2>
            <div class="action-buttons">
              <a href="#" class="btn">Créer une partie</a>
              <a href="#" class="btn">Ajouter un utilisateur</a>
              <a href="#" class="btn">Générer des rapports</a>
              <a href="#" class="btn">Modifier les paramètres</a>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Panneau: Gestion des parties -->
      <div id="games-panel" class="panel" style="display: none;">
        <h1>Gestion des parties</h1>
        
        <div class="card">
          <h2>Simulation de partie</h2>
          <div class="game-controls">
            <button class="btn" id="start-game">Démarrer la partie</button>
            <button class="btn" id="draw-number">Tirer un numéro</button>
            <button class="btn" id="announce-quine">Annoncer la quine</button>
            <button class="btn" id="announce-bingo">Annoncer le bingo</button>
            <button class="btn btn-secondary" id="reset-game">Réinitialiser</button>
          </div>
          
          <div class="game-display">
            <div class="game-board">
              <h3>Numéros tirés</h3>
              <div class="bingo-grid" id="numbers-grid">
                <!-- Grille des numéros 1-90 générée par JavaScript -->
              </div>
            </div>
            
            <div class="chat-panel">
              <div class="chat-header">
                Messages système
              </div>
              <div class="chat-messages" id="system-messages">
                <div>Connexion au serveur de jeu...</div>
                <div>Serveur prêt</div>
                <div>En attente du démarrage de la partie</div>
              </div>
              <div class="chat-input">
                <div class="input-group">
                  <input type="text" placeholder="Saisir un message..." id="system-message-input">
                  <button id="send-system-message">➤</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Panneau: Utilisateurs -->
      <div id="users-panel" class="panel" style="display: none;">
        <h1>Gestion des utilisateurs</h1>
        
        <div class="card">
          <h2>Liste des utilisateurs</h2>
          <ul class="user-list" id="user-list">
            <li>
              <div>
                <strong>Admin</strong> 
                <span>(admin@pacifique-ms-bingo.com)</span>
              </div>
              <div class="actions">
                <button>Éditer</button>
                <button>Supprimer</button>
              </div>
            </li>
          </ul>
        </div>
        
        <div class="card">
          <h2>Ajouter un utilisateur</h2>
          <form id="add-user-form">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
              <div style="margin-bottom: 10px;">
                <label style="display: block; margin-bottom: 5px;">Nom d'utilisateur</label>
                <input type="text" style="width: 100%; padding: 8px; background: #333; border: 1px solid #555; color: white; border-radius: 4px;">
              </div>
              <div style="margin-bottom: 10px;">
                <label style="display: block; margin-bottom: 5px;">Email</label>
                <input type="email" style="width: 100%; padding: 8px; background: #333; border: 1px solid #555; color: white; border-radius: 4px;">
              </div>
              <div style="margin-bottom: 10px;">
                <label style="display: block; margin-bottom: 5px;">Mot de passe</label>
                <input type="password" style="width: 100%; padding: 8px; background: #333; border: 1px solid #555; color: white; border-radius: 4px;">
              </div>
              <div style="margin-bottom: 10px;">
                <label style="display: block; margin-bottom: 5px;">Solde initial (Fr)</label>
                <input type="number" style="width: 100%; padding: 8px; background: #333; border: 1px solid #555; color: white; border-radius: 4px;" value="1000">
              </div>
            </div>
            <div style="margin-top: 10px;">
              <button type="submit" class="btn">Ajouter l'utilisateur</button>
            </div>
          </form>
        </div>
      </div>

      <!-- Panneau: Transactions -->
      <div id="transactions-panel" class="panel" style="display: none;">
        <h1>Historique des transactions</h1>
        
        <div class="card">
          <h2>Transactions récentes</h2>
          <div style="overflow-x: auto;">
            <table style="width: 100%; border-collapse: collapse;">
              <thead>
                <tr style="background-color: #222; color: #ff3b3b;">
                  <th style="padding: 10px; text-align: left;">Date</th>
                  <th style="padding: 10px; text-align: left;">Utilisateur</th>
                  <th style="padding: 10px; text-align: left;">Type</th>
                  <th style="padding: 10px; text-align: left;">Montant</th>
                  <th style="padding: 10px; text-align: left;">Statut</th>
                  <th style="padding: 10px; text-align: left;">Actions</th>
                </tr>
              </thead>
              <tbody id="transactions-list">
                <tr style="border-bottom: 1px solid #444;">
                  <td style="padding: 10px;">10/04/2025 20:15</td>
                  <td style="padding: 10px;">Admin</td>
                  <td style="padding: 10px;">Gain (Quine)</td>
                  <td style="padding: 10px;">+500 Fr</td>
                  <td style="padding: 10px;">Complété</td>
                  <td style="padding: 10px;">
                    <button class="btn btn-secondary" style="padding: 5px 10px; font-size: 12px;">Détails</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Panneau: Jackpot -->
      <div id="jackpot-panel" class="panel" style="display: none;">
        <h1>Gestion du jackpot</h1>
        
        <div class="card">
          <h2>État du jackpot</h2>
          <div class="stat-item" style="max-width: 300px; margin-bottom: 20px;">
            <div class="stat-value" id="current-jackpot">100000</div>
            <div class="stat-label">Jackpot actuel (Fr)</div>
          </div>
          
          <div style="margin-bottom: 20px;">
            <h3>Modifier le jackpot</h3>
            <div style="display: flex; gap: 10px; align-items: flex-end;">
              <div>
                <label style="display: block; margin-bottom: 5px;">Nouveau montant (Fr)</label>
                <input type="number" id="new-jackpot" style="width: 200px; padding: 8px; background: #333; border: 1px solid #555; color: white; border-radius: 4px;" value="100000">
              </div>
              <button class="btn" id="update-jackpot">Mettre à jour</button>
            </div>
          </div>
          
          <div>
            <h3>Historique des jackpots gagnés</h3>
            <table style="width: 100%; border-collapse: collapse;">
              <thead>
                <tr style="background-color: #222; color: #ff3b3b;">
                  <th style="padding: 10px; text-align: left;">Date</th>
                  <th style="padding: 10px; text-align: left;">Utilisateur</th>
                  <th style="padding: 10px; text-align: left;">Montant</th>
                  <th style="padding: 10px; text-align: left;">Numéros tirés</th>
                </tr>
              </thead>
              <tbody id="jackpot-history">
                <!-- Historique des jackpots généré dynamiquement -->
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Panneau: Configuration -->
      <div id="settings-panel" class="panel" style="display: none;">
        <h1>Configuration du système</h1>
        
        <div class="card">
          <h2>Paramètres généraux</h2>
          <form id="general-settings-form">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
              <div>
                <h3>Horaires des parties</h3>
                <div style="margin-bottom: 10px;">
                  <label style="display: block; margin-bottom: 5px;">Heure de début (24h)</label>
                  <input type="text" style="width: 100%; padding: 8px; background: #333; border: 1px solid #555; color: white; border-radius: 4px;" value="10:00">
                </div>
                <div style="margin-bottom: 10px;">
                  <label style="display: block; margin-bottom: 5px;">Heure de fin (24h)</label>
                  <input type="text" style="width: 100%; padding: 8px; background: #333; border: 1px solid #555; color: white; border-radius: 4px;" value="03:00">
                </div>
              </div>
              
              <div>
                <h3>Prix des cartes</h3>
                <div style="margin-bottom: 10px;">
                  <label style="display: block; margin-bottom: 5px;">Prix - partie standard (Fr)</label>
                  <input type="number" style="width: 100%; padding: 8px; background: #333; border: 1px solid #555; color: white; border-radius: 4px;" value="100">
                </div>
                <div style="margin-bottom: 10px;">
                  <label style="display: block; margin-bottom: 5px;">Prix - partie spéciale (Fr)</label>
                  <input type="number" style="width: 100%; padding: 8px; background: #333; border: 1px solid #555; color: white; border-radius: 4px;" value="300">
                </div>
              </div>
              
              <div>
                <h3>Répartition des gains</h3>
                <div style="margin-bottom: 10px;">
                  <label style="display: block; margin-bottom: 5px;">Quine (%)</label>
                  <input type="number" style="width: 100%; padding: 8px; background: #333; border: 1px solid #555; color: white; border-radius: 4px;" value="15">
                </div>
                <div style="margin-bottom: 10px;">
                  <label style="display: block; margin-bottom: 5px;">Bingo (%)</label>
                  <input type="number" style="width: 100%; padding: 8px; background: #333; border: 1px solid #555; color: white; border-radius: 4px;" value="50">
                </div>
                <div style="margin-bottom: 10px;">
                  <label style="display: block; margin-bottom: 5px;">Jackpot (%)</label>
                  <input type="number" style="width: 100%; padding: 8px; background: #333; border: 1px solid #555; color: white; border-radius: 4px;" value="5">
                </div>
                <div style="margin-bottom: 10px;">
                  <label style="display: block; margin-bottom: 5px;">Plateforme (%)</label>
                  <input type="number" style="width: 100%; padding: 8px; background: #333; border: 1px solid #555; color: white; border-radius: 4px;" value="30">
                </div>
              </div>
              
              <div>
                <h3>Paramètres du jackpot</h3>
                <div style="margin-bottom: 10px;">
                  <label style="display: block; margin-bottom: 5px;">Nombre max de tirages pour gagner</label>
                  <input type="number" style="width: 100%; padding: 8px; background: #333; border: 1px solid #555; color: white; border-radius: 4px;" value="40">
                </div>
                <div style="margin-bottom: 10px;">
                  <label style="display: block; margin-bottom: 5px;">Montant initial (Fr)</label>
                  <input type="number" style="width: 100%; padding: 8px; background: #333; border: 1px solid #555; color: white; border-radius: 4px;" value="100000">
                </div>
              </div>
            </div>
            
            <div style="margin-top: 20px;">
              <button type="submit" class="btn">Enregistrer les modifications</button>
            </div>
          </form>
        </div>
      </div>
      
      <div class="card" id="game-card-preview">
        <h2>Aperçu des cartes</h2>
        <div class="card-preview">
          <div>Carte exemple</div>
          <div class="card-grid">
            <!-- Première ligne -->
            <div class="card-cell"></div>
            <div class="card-cell">16</div>
            <div class="card-cell"></div>
            <div class="card-cell">37</div>
            <div class="card-cell">43</div>
            <div class="card-cell"></div>
            <div class="card-cell">68</div>
            <div class="card-cell">78</div>
            <div class="card-cell"></div>
            
            <!-- Deuxième ligne -->
            <div class="card-cell">1</div>
            <div class="card-cell"></div>
            <div class="card-cell">28</div>
            <div class="card-cell"></div>
            <div class="card-cell"></div>
            <div class="card-cell">59</div>
            <div class="card-cell"></div>
            <div class="card-cell"></div>
            <div class="card-cell">89</div>
            
            <!-- Troisième ligne -->
            <div class="card-cell"></div>
            <div class="card-cell">12</div>
            <div class="card-cell"></div>
            <div class="card-cell">32</div>
            <div class="card-cell">47</div>
            <div class="card-cell"></div>
            <div class="card-cell">64</div>
            <div class="card-cell">75</div>
            <div class="card-cell"></div>
          </div>
        </div>
        <div class="action-buttons">
          <button class="btn" id="generate-card">Générer une nouvelle carte</button>
          <button class="btn" id="validate-card">Vérifier la carte</button>
        </div>
      </div>
    </div>
    
    <div class="footer">
      PACIFIQUE MS BINGO Administration © 2025 - Version 1.0
    </div>
  </div>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Générer la grille de numéros 1-90
      const numbersGrid = document.getElementById('numbers-grid');
      if (numbersGrid) {
        for (let i = 1; i <= 90; i++) {
          const cell = document.createElement('div');
          cell.className = 'bingo-cell';
          cell.textContent = i;
          cell.dataset.number = i;
          numbersGrid.appendChild(cell);
        }
      }
      
      // Navigation entre les panneaux
      document.querySelectorAll('.nav-links a').forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          
          // Retirer la classe active de tous les liens et masquer tous les panneaux
          document.querySelectorAll('.nav-links a').forEach(el => el.classList.remove('active'));
          document.querySelectorAll('.panel').forEach(el => el.style.display = 'none');
          
          // Ajouter la classe active au lien cliqué
          this.classList.add('active');
          
          // Afficher le panneau correspondant
          const panelId = this.getAttribute('data-panel') + '-panel';
          document.getElementById(panelId).style.display = 'block';
          
          // Afficher/masquer l'aperçu des cartes selon le panneau
          const gameCardPreview = document.getElementById('game-card-preview');
          if (gameCardPreview) {
            gameCardPreview.style.display = ['dashboard-panel', 'games-panel'].includes(panelId) ? 'block' : 'none';
          }
        });
      });
      
      // Simulation de tirage de numéro
      let drawnNumbers = [];
      
      document.getElementById('draw-number')?.addEventListener('click', function() {
        if (drawnNumbers.length >= 90) {
          addSystemMessage('Tous les numéros ont été tirés.');
          return;
        }
        
        let number;
        do {
          number = Math.floor(Math.random() * 90) + 1;
        } while (drawnNumbers.includes(number));
        
        drawnNumbers.push(number);
        
        // Mise à jour visuelle
        const cell = document.querySelector(`.bingo-cell[data-number="${number}"]`);
        if (cell) {
          cell.classList.add('drawn');
        }
        
        addSystemMessage(`Numéro tiré: ${number}`);
      });
      
      // Réinitialiser la simulation
      document.getElementById('reset-game')?.addEventListener('click', function() {
        drawnNumbers = [];
        document.querySelectorAll('.bingo-cell').forEach(cell => {
          cell.classList.remove('drawn');
        });
        addSystemMessage('Partie réinitialisée');
      });
      
      // Gestion des messages système
      function addSystemMessage(message) {
        const messagesContainer = document.getElementById('system-messages');
        if (messagesContainer) {
          const messageEl = document.createElement('div');
          messageEl.textContent = message;
          messagesContainer.appendChild(messageEl);
          messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
      }
      
      // Envoi de message système
      document.getElementById('send-system-message')?.addEventListener('click', function() {
        const input = document.getElementById('system-message-input');
        if (input && input.value.trim()) {
          addSystemMessage(`Admin: ${input.value.trim()}`);
          input.value = '';
        }
      });
      
      // Gestion de l'entrée de message avec la touche Entrée
      document.getElementById('system-message-input')?.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          document.getElementById('send-system-message').click();
        }
      });
      
      // Simulation des boutons de partie
      document.getElementById('start-game')?.addEventListener('click', function() {
        addSystemMessage('Partie démarrée');
      });
      
      document.getElementById('announce-quine')?.addEventListener('click', function() {
        addSystemMessage('QUINE annoncée !');
      });
      
      document.getElementById('announce-bingo')?.addEventListener('click', function() {
        addSystemMessage('BINGO annoncé !');
      });
      
      // Vérification de la base de données
      document.getElementById('check-db')?.addEventListener('click', function() {
        addSystemMessage('Vérification de la base de données...');
        
        fetch('/debug/storage')
          .then(response => response.json())
          .then(data => {
            addSystemMessage(`Base de données OK: ${data.userCount} utilisateurs`);
            
            // Mise à jour des statistiques
            document.getElementById('users-count').textContent = data.userCount;
          })
          .catch(error => {
            addSystemMessage(`Erreur: ${error.message}`);
          });
      });
      
      // Génération de carte
      document.getElementById('generate-card')?.addEventListener('click', function() {
        // Simulation de génération d'une nouvelle carte
        const cardCells = document.querySelectorAll('.card-grid .card-cell');
        
        // Réinitialiser toutes les cellules
        cardCells.forEach(cell => {
          cell.textContent = '';
        });
        
        // Générer 5 numéros par ligne
        for (let row = 0; row < 3; row++) {
          // Obtenir 5 indices aléatoires différents pour cette ligne
          const colIndices = [];
          while (colIndices.length < 5) {
            const randomCol = Math.floor(Math.random() * 9);
            if (!colIndices.includes(randomCol)) {
              colIndices.push(randomCol);
            }
          }
          
          // Remplir les cases avec des numéros appropriés
          colIndices.forEach(col => {
            const cellIndex = row * 9 + col;
            const minNum = col * 10 + 1;
            const maxNum = (col === 8) ? 90 : (col + 1) * 10;
            const number = Math.floor(Math.random() * (maxNum - minNum + 1)) + minNum;
            
            cardCells[cellIndex].textContent = number;
          });
        }
      });
      
      // Mode maintenance
      document.getElementById('maintenance-mode')?.addEventListener('change', function() {
        const status = this.checked ? 'activé' : 'désactivé';
        addSystemMessage(`Mode maintenance ${status}`);
      });
      
      // Afficher les statistiques initiales
      fetch('/api/admin/stats')
        .then(response => response.json())
        .then(data => {
          document.getElementById('users-count').textContent = data.usersCount || 0;
          document.getElementById('games-count').textContent = data.gamesCount || 0;
          document.getElementById('cards-count').textContent = data.cardsCount || 0;
          
          const jackpotAmount = data.jackpot || 100000;
          document.getElementById('jackpot-amount').textContent = jackpotAmount;
          document.getElementById('current-jackpot').textContent = jackpotAmount;
          document.getElementById('new-jackpot').value = jackpotAmount;
        })
        .catch(error => {
          console.error('Erreur lors de la récupération des statistiques:', error);
        });
      
      // Charger la liste des utilisateurs
      fetch('/api/admin/users')
        .then(response => response.json())
        .then(users => {
          const userList = document.getElementById('user-list');
          if (userList && users.length > 0) {
            userList.innerHTML = '';
            
            users.forEach(user => {
              const li = document.createElement('li');
              li.innerHTML = `
                <div>
                  <strong>${user.username}</strong>
                  ${user.email ? `<span>(${user.email})</span>` : ''}
                  ${user.is_admin ? '<span style="color: #ff3b3b; margin-left: 5px;">[Admin]</span>' : ''}
                </div>
                <div class="actions">
                  <button>Éditer</button>
                  <button>Supprimer</button>
                </div>
              `;
              userList.appendChild(li);
            });
          }
        })
        .catch(error => {
          console.error('Erreur lors de la récupération des utilisateurs:', error);
        });
      
      // Mettre à jour le jackpot
      document.getElementById('update-jackpot')?.addEventListener('click', function() {
        const newAmount = document.getElementById('new-jackpot').value;
        
        // Mise à jour de l'affichage
        document.getElementById('jackpot-amount').textContent = newAmount;
        document.getElementById('current-jackpot').textContent = newAmount;
        
        addSystemMessage(`Jackpot mis à jour: ${newAmount} Fr`);
      });
      
      // Validation d'une carte
      document.getElementById('validate-card')?.addEventListener('click', function() {
        addSystemMessage('Carte validée');
      });
      
      // Démarrer une partie test
      document.getElementById('start-test-game')?.addEventListener('click', function() {
        addSystemMessage('Partie test démarrée');
        
        // Basculer vers l'onglet de gestion des parties
        document.querySelector('.nav-links a[data-panel="games"]').click();
      });
    });
  </script>
</body>
</html>